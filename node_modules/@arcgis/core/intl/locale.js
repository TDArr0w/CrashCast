/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.34/esri/copyright.txt for details.
*/
import{makeHandle as n}from"../core/handleUtils.js";import"../core/has.js";let e,t;const o=globalThis.esriConfig?.locale??globalThis.dojoConfig?.locale,a=globalThis.document?.documentElement;function r(){const n=a?.getAttribute("lang"),e=globalThis.navigator?.language;return o??n??e??"en"}function l(){return void 0===t&&(t=r()),t}function i(n){e=n||void 0,x()}const c=/^(?<language>[a-z]{2,3})(?:-(?<extlang>[a-z]{3}))?(?:-[A-Z][a-z]{3})?(?:-(?<region>[A-Z]{2}|\d{3}))?(?:-.*)?$/;function s(n=l()){return g(n)?.language}function u(n=l()){const e=g(n);return e?.language&&e?.extlang?n.replace(`${e.language}-`,""):n}function g(n=l()){return c.exec(n)?.groups}function f(n=l()){const e=g(n)?.language;return"he"===e||"ar"===e}const h=[],d=new Map;function p(){const n=Array.from(d.values())[0];d.clear();const e=h.length;if(0!==e)throw new Error(`Unexpected ${e} locale change listeners still active.${n?` For example:\n${n}`:" Set enableListenerTracing in esri/intl/locale.ts to include a stack trace."}`)}function b(e){return h.push(e),n(()=>{h.splice(h.indexOf(e),1)})}const m=[];function v(e){return m.push(e),n(()=>m.splice(m.indexOf(e),1))}function x(){const n=e??r();t!==n&&([...m].forEach(e=>e(n)),t=n,[...h].forEach(e=>e(n)))}if(globalThis.addEventListener?.("languagechange",x),a){new MutationObserver(()=>{x()}).observe(a,{attributeFilter:["lang"]})}export{p as assertNoLocaleChangeListeners,v as beforeLocaleChange,r as getDefaultLocale,l as getLocale,s as getLocaleLanguage,g as getLocaleParts,u as normalizeLocale,b as onLocaleChange,f as prefersRTL,i as setLocale};
