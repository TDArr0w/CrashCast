/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.34/esri/copyright.txt for details.
*/
import{deg2rad as e}from"../../core/mathUtils.js";import{create as r}from"../../core/libs/gl-matrix-2/factories/vec3f64.js";import{getProjectorClassification as t,copy3 as s,projectionTable as n,wgs84ToWebMercator as o}from"./projectors.js";import{earth as i}from"../support/Ellipsoid.js";import{a as c,e as a}from"../../chunks/sphere.js";function l(e,r,l,m){if(null==r||null==m)return!1;const d=t(r,m);if(null==d?.projector)return!1;if(d.projector===s)return e!==l&&(l[0]=e[0],l[1]=e[1],l[2]=e[2],l[3]=e[3]),!0;const{source:j,dest:h,projector:I}=d;if(3===h.spatialReferenceId){const r=n[j.spatialReferenceId][2];if(null==r)return!1;r(c(e),0,f,0),o(f,0,p,0);const t=u(f[1],e[2],e[3],i.radius);return a(l,p,t),!0}if(2!==j.spatialReferenceId&&5!==j.spatialReferenceId||11!==h.spatialReferenceId){I(c(e),0,p,0);const r=j.metersPerUnit??1,t=h.metersPerUnit??1,s=e[3]*r/t;a(l,p,s)}else{const r=n[j.spatialReferenceId][1],t=n[1][11];let s=e[3];null!=r&&null!=t&&(s=u(e[1],e[2],e[3],i.radius)),I(c(e),0,p,0),a(l,p,s)}return!0}function u(e,r,t,s){const n=s+r;if(n<s/2||t>n)return Number.MAX_VALUE;const o=Math.abs(m*e)+Math.asin(t/n);return o>=Math.PI/2?Number.MAX_VALUE:t/Math.cos(o)}const f=r(),p=r(),m=e(1);export{l as projectBoundingSphere};
