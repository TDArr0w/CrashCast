/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.34/esri/copyright.txt for details.
*/
import{__decorate as t}from"tslib";import{clone as e}from"../core/lang.js";import{property as r}from"../core/accessorSupport/decorators/property.js";import"../core/has.js";import"../core/Logger.js";import{subclass as s}from"../core/accessorSupport/decorators/subclass.js";import{writer as i}from"../core/accessorSupport/decorators/writer.js";import a from"./Extent.js";import o from"./Geometry.js";import n from"./Point.js";import h from"./SpatialReference.js";import{getPolylineExtent as p}from"./support/extentUtils.js";import{updateSupportFromPoint as l}from"./support/zmUtils.js";var c;function u(t){return!Array.isArray(t[0])}function f(t){return"number"==typeof t[0]?.[0]}function m(t){if(!t)return;let{paths:e,hasM:r,hasZ:s,spatialReference:i}=t;switch(e??=[],f(e)&&(e=[e]),e[0]?.[0]?.length){case 4:s??=!0,r??=!0;break;case 3:s??=!0!==r,r??=!s;break;default:s??=!1,r??=!1}return i??=h.WGS84,{...t,hasM:r,hasZ:s,paths:e,spatialReference:i}}let y=c=class extends o{constructor(t){super(m(t)),this.curvePaths=void 0,this.paths=[],this.type="polyline"}get cache(){return this.commitProperty("curvePaths"),this.commitProperty("hasM"),this.commitProperty("hasZ"),this.commitProperty("paths"),this.commitProperty("spatialReference"),{}}writeCurvePaths(t,r){r.curvePaths=e(t)}get extent(){const t=p(this),{spatialReference:e}=this;return t?new a({...t,spatialReference:e}):null}writePaths(t,r){r.paths=e(this.paths)}addPath(t){if(!t)return;const e=this.paths,r=e.length;if(u(t)){const s=[];for(let e=0,r=t.length;e<r;e++)s[e]=t[e].toArray();e[r]=s}else e[r]=t.slice();return this.notifyChange("paths"),this}clone(){const t=new c;return t.spatialReference=this.spatialReference,t.paths=e(this.paths),t.curvePaths=e(this.curvePaths),t.hasZ=this.hasZ,t.hasM=this.hasM,t}getPoint(t,e){if(!this._validateInputs(t,e))return null;const r=this.paths[t][e],s=this.hasZ,i=this.hasM;return s&&!i?new n(r[0],r[1],r[2],void 0,this.spatialReference):i&&!s?new n(r[0],r[1],void 0,r[2],this.spatialReference):s&&i?new n(r[0],r[1],r[2],r[3],this.spatialReference):new n(r[0],r[1],this.spatialReference)}insertPoint(t,e,r){return this._validateInputs(t,e,!0)?(l(this,r),Array.isArray(r)||(r=r.toArray()),this.paths[t].splice(e,0,r),this.notifyChange("paths"),this):this}removePath(t){if(!this._validateInputs(t,null))return null;const e=this.paths.splice(t,1)[0],r=this.spatialReference,s=e.map(t=>new n(t,r));return this.notifyChange("paths"),s}removePoint(t,e){if(!this._validateInputs(t,e))return null;const r=new n(this.paths[t].splice(e,1)[0],this.spatialReference);return this.notifyChange("paths"),r}setPoint(t,e,r){return this._validateInputs(t,e)?(l(this,r),Array.isArray(r)||(r=r.toArray()),this.paths[t][e]=r,this.notifyChange("paths"),this):this}_validateInputs(t,e,r=!1){if(null==t||t<0||t>=this.paths.length)return!1;if(null!=e){const s=this.paths[t];if(r&&(e<0||e>s.length))return!1;if(!r&&(e<0||e>=s.length))return!1}return!0}toJSON(t){return this.write({},t)}};t([r({readOnly:!0})],y.prototype,"cache",null),t([r({json:{write:!0,origins:{"portal-item":{write:!1},"web-map":{write:!1},"web-scene":{write:!1}}}})],y.prototype,"curvePaths",void 0),t([i("curvePaths")],y.prototype,"writeCurvePaths",null),t([r({readOnly:!0})],y.prototype,"extent",null),t([r({type:[[[Number]]],json:{write:{isRequired:!0}}})],y.prototype,"paths",void 0),t([i("paths")],y.prototype,"writePaths",null),y=c=t([s("esri.geometry.Polyline")],y),y.prototype.toJSON.isDefaultToJSON=!0;export{y as default};
