/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.34/esri/copyright.txt for details.
*/
import{hasScaling as r,deg2rad as t}from"../../../core/mathUtils.js";import{normalFromMat4 as o,fromMat4 as e}from"../../../core/libs/gl-matrix-2/math/mat3.js";import{create as n}from"../../../core/libs/gl-matrix-2/factories/mat3f64.js";import{invert as i}from"../../../core/libs/gl-matrix-2/math/mat4.js";import{create as f}from"../../../core/libs/gl-matrix-2/factories/mat4f64.js";import{o as c,n as s}from"../../../chunks/vec32.js";import{create as a}from"../../../core/libs/gl-matrix-2/factories/vec3f64.js";import{computeTranslationToOriginAndRotation as m}from"../../projection/computeTranslationToOriginAndRotation.js";import{projectBuffer as u}from"../../projection/projectBuffer.js";import{earth as l}from"../Ellipsoid.js";import{isCGCS2000 as p,isMars as y,isMoon as d}from"../spatialReferenceUtils.js";import{y2lat as T}from"../webMercatorUtils.js";import{BufferViewVec3f as j,BufferViewVec3f64 as A}from"../buffer/BufferView.js";import{b as g,n as h}from"../../../chunks/vec3.js";import{t as E}from"../../../chunks/vec4.js";const b="Projection may be possible after calling projection.load().";function k(r,t,o,e){r.error(`Failed to project from (wkid:${t.wkid}) to (wkid:${o.wkid}).${e?" ":""}${e}`)}function w(r,t,o,e,n,i){return U(0,j.fromTypedArray(r),0,A.fromTypedArray(t),o,A.fromTypedArray(e),n,j.fromTypedArray(i))?i:null}function M(r,t,o,e,n,i){return U(1,j.fromTypedArray(r),0,A.fromTypedArray(t),o,A.fromTypedArray(e),n,j.fromTypedArray(i))?i:null}function V(r,t,o,e){return u(r,t,0,o,e,0)?o:null}function x(r,t,o,e){return u(r,t,0,o,e,0)?o:null}function v(t,e,n){return o(G,n),g(e,t,G),r(G)&&h(e,e),e}function B(t,o,n){return e(G,n),E(o,t,G),r(G)&&h(o,o,4),o}function R(r,o,e,n){const i=0===o;return _(r,o,e,(r,o)=>{const e=Math.cos(t(r));o[0]=i?e:1/e,o[1]=1},n)}function $(r,t,o,e){const n=0===t;return _(r,t,o,(r,t)=>{const o=Math.cosh(-r/l.radius);t[0]=1,t[1]=n?o:1/o},e)}function _(r,t,o,e,n){const i=0===t?3:4,f=[0,0];for(let c=0,s=1;c<r.length;c+=i,s+=3){e(o[s],f);const t=r[c]*f[0],a=r[c+1]*f[1],m=r[c+2],u=1/Math.sqrt(t*t+a*a+m*m);n[c]=t*u,n[c+1]=a*u,n[c+2]=m*u,4===i&&(n[c+3]=r[c+3])}return n}function F(r,t,o,e,n,i){if(!U(0,j.fromTypedArray(r,4*Float32Array.BYTES_PER_ELEMENT),1,A.fromTypedArray(t),o,A.fromTypedArray(e),n,j.fromTypedArray(i,4*Float32Array.BYTES_PER_ELEMENT)))return null;for(let f=3;f<r.length;f+=4)i[f]=r[f];return i}function P(r,t,o,e,n,i){if(!U(1,j.fromTypedArray(r,16),1,A.fromTypedArray(t),o,A.fromTypedArray(e),n,j.fromTypedArray(i,16)))return null;for(let f=3;f<r.length;f+=4)i[f]=r[f];return i}function S(r,t,n,f,c){switch(m(f,n,q,f),1===r&&i(q,q),t){case 0:return o(c,q);case 1:return e(c,q)}}function U(r,t,o,e,n,i,f,a){if(!t)return;const m=e.count;if(L(n))for(let s=0;s<m;s++)i.getVec(s,N),t.getVec(s,Y),c(Y,Y,S(r,o,N,f,G)),a.setVec(s,Y);else for(let u=0;u<m;u++){i.getVec(u,N),t.getVec(u,Y);const n=T(e.get(u,1));let m=Math.cos(n);1===o!=(0===r)&&(m=1/m),S(r,o,N,f,G),0===r?(G[0]*=m,G[1]*=m,G[2]*=m,G[3]*=m,G[4]*=m,G[5]*=m):(G[0]*=m,G[3]*=m,G[6]*=m,G[1]*=m,G[4]*=m,G[7]*=m),c(Y,Y,G),s(Y,Y),a.setVec(u,Y)}return a}function L(r){return r.isWGS84||p(r)||y(r)||d(r)}const N=a(),Y=a(),q=f(),G=n();export{b as loadProjectErrorMessage,k as logProjectionError,x as projectFromPCPF,M as projectNormalFromPCPF,w as projectNormalToPCPF,P as projectTangentFromPCPF,F as projectTangentToPCPF,V as projectToPCPF,v as transformNormal,B as transformTangent,R as transformVectorENUPlateCarree,$ as transformVectorWMPlateCarree};
