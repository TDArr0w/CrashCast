/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.34/esri/copyright.txt for details.
*/
import{ArcadeExecutionError as e}from"../executionError.js";import{shapeExtent as t}from"../kernel.js";import{C as n,B as r,h as s,u as i,m as a}from"../../chunks/languageUtils.js";import o from"../featureset/actions/SpatialFilter.js";import u from"../featureset/sources/Empty.js";import{invokeRemoteGeometryOp as l}from"../geometry/operatorsWorkerConnection.js";function c(i){return async(c,f,p)=>{if(r(p,2,2,c,f),null===(p=n(p))[0]&&null===p[1])return!1;if(a(p[0])){if(s(p[1]))return new o({parentfeatureset:p[0],relation:i,relationGeom:p[1]});if(null===p[1])return new u({parentfeatureset:p[0]});throw new e(c,"InvalidParameter",f)}if(s(p[0])){if(s(p[1])){switch(i){case"esriSpatialRelEnvelopeIntersects":{const e=t(p[0]),n=t(p[1]);return null!=e&&null!=n&&l("intersects",[e.toJSON(),n.toJSON()])}case"esriSpatialRelIntersects":return l("intersects",[p[0].toJSON(),p[1].toJSON()]);case"esriSpatialRelContains":return l("contains",[p[0].toJSON(),p[1].toJSON()]);case"esriSpatialRelOverlaps":return l("overlaps",[p[0].toJSON(),p[1].toJSON()]);case"esriSpatialRelWithin":return l("within",[p[0].toJSON(),p[1].toJSON()]);case"esriSpatialRelTouches":return l("touches",[p[0].toJSON(),p[1].toJSON()]);case"esriSpatialRelCrosses":return l("crosses",[p[0].toJSON(),p[1].toJSON()])}throw new e(c,"InvalidParameter",f)}if(a(p[1]))return new o({parentfeatureset:p[1],relation:i,relationGeom:p[0]});if(null===p[1])return!1;throw new e(c,"InvalidParameter",f)}if(null===p[0]){if(a(p[1]))return new u({parentfeatureset:p[1]});if(s(p[1])||null===p[1])return!1}throw new e(c,"InvalidParameter",f)}}function f(t){"async"===t.mode&&(t.functions.intersects=function(e,n){return t.standardFunctionAsync(e,n,c("esriSpatialRelIntersects"))},t.functions.envelopeintersects=function(e,n){return t.standardFunctionAsync(e,n,c("esriSpatialRelEnvelopeIntersects"))},t.signatures.push({name:"envelopeintersects",min:2,max:2}),t.functions.contains=function(e,n){return t.standardFunctionAsync(e,n,c("esriSpatialRelContains"))},t.functions.overlaps=function(e,n){return t.standardFunctionAsync(e,n,c("esriSpatialRelOverlaps"))},t.functions.within=function(e,n){return t.standardFunctionAsync(e,n,c("esriSpatialRelWithin"))},t.functions.touches=function(e,n){return t.standardFunctionAsync(e,n,c("esriSpatialRelTouches"))},t.functions.crosses=function(e,n){return t.standardFunctionAsync(e,n,c("esriSpatialRelCrosses"))},t.functions.relate=function(o,c){return t.standardFunctionAsync(o,c,async(t,f,p)=>{if(p=n(p),r(p,3,3,o,c),s(p[0])&&s(p[1]))return l("relate",[p[0].toJSON(),p[1].toJSON(),i(p[2])]);if(s(p[0])&&null===p[1])return!1;if(s(p[1])&&null===p[0])return!1;if(a(p[0])&&null===p[1])return new u({parentfeatureset:p[0]});if(a(p[1])&&null===p[0])return new u({parentfeatureset:p[1]});if(a(p[0])&&s(p[1]))return p[0].relate(p[1],i(p[2]));if(a(p[1])&&s(p[0]))return p[1].relate(p[0],i(p[2]));if(null===p[0]&&null===p[1])return!1;throw new e(o,"InvalidParameter",c)})})}export{f as registerFunctions};
