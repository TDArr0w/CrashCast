"use strict";(self.webpackChunkRemoteClient=self.webpackChunkRemoteClient||[]).push([[9647],{6518:(e,t,n)=>{n.d(t,{F:()=>a});var i=n(44208),r=n(75503),s=n(19419);const o={minX:0,minY:0,maxX:0,maxY:0};class a{constructor(){this._indexInvalid=!1,this._boundsToLoad=[],this._boundsById=new Map,this._idByBounds=new Map,this._index=new r.wq(9,(0,i.A)("esri-csp-restrictions")?e=>({minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]}):["[0]","[1]","[2]","[3]"]),this._loadIndex=()=>{if(this._indexInvalid){const e=new Array(this._idByBounds.size);let t=0;this._idByBounds.forEach((n,i)=>{e[t++]=i}),this._indexInvalid=!1,this._index.clear(),this._index.load(e)}else this._boundsToLoad.length&&(this._index.load(Array.from(new Set(this._boundsToLoad.filter(e=>this._idByBounds.has(e))))),this._boundsToLoad.length=0)}}get fullBounds(){if(!this._boundsById.size)return null;const e=(0,s.Ie)();for(const t of this._boundsById.values())t&&(e[0]=Math.min(t[0],e[0]),e[1]=Math.min(t[1],e[1]),e[2]=Math.max(t[2],e[2]),e[3]=Math.max(t[3],e[3]));return e}get valid(){return!this._indexInvalid}clear(){this._indexInvalid=!1,this._boundsToLoad.length=0,this._boundsById.clear(),this._idByBounds.clear(),this._index.clear()}delete(e){const t=this._boundsById.get(e);this._boundsById.delete(e),t&&(this._idByBounds.delete(t),this._indexInvalid||this._index.remove(t))}forEachInBounds(e,t){this._loadIndex(),function(e,t,n){(function(e){o.minX=e[0],o.minY=e[1],o.maxX=e[2],o.maxY=e[3]})(t),e.search(o,n)}(this._index,e,e=>t(this._idByBounds.get(e)))}get(e){return this._boundsById.get(e)}has(e){return this._boundsById.has(e)}invalidateIndex(){this._indexInvalid||(this._indexInvalid=!0,this._boundsToLoad.length=0)}set(e,t){if(!this._indexInvalid){const t=this._boundsById.get(e);t&&(this._index.remove(t),this._idByBounds.delete(t))}this._boundsById.set(e,t),t&&(this._idByBounds.set(t,e),this._indexInvalid||(this._boundsToLoad.push(t),this._boundsToLoad.length>5e4&&this._loadIndex()))}}},8303:(e,t,n)=>{n.d(t,{A:()=>P});var i=n(31635),r=n(92602),s=n(70333),o=n(78888),a=n(60999),l=n(49186),c=n(53966),u=n(97768),h=n(74887),d=n(84952),p=n(10107),m=(n(44208),n(87811),n(36005)),f=n(64108),g=n(43937),y=n(77548),x=n(20655),_=n(80812),v=n(41318),w=n(10407);const P=e=>{const t=e;let P=class extends t{constructor(){super(...arguments),this.resourceReferences={portalItem:null,paths:[]},this.userHasEditingPrivileges=!0,this.userHasFullEditingPrivileges=!1,this.userHasUpdateItemPrivileges=!1}destroy(){this.portalItem=(0,u.pR)(this.portalItem),this.resourceReferences.portalItem=null,this.resourceReferences.paths.length=0}set portalItem(e){e!==this._get("portalItem")&&(this.removeOrigin("portal-item"),this._set("portalItem",e))}readPortalItem(e,t,n){if(t.itemId)return new _.default({id:t.itemId,portal:n?.portal})}writePortalItem(e,t){e?.id&&(t.itemId=e.id)}async loadFromPortal(e,t){if(this.portalItem?.id)try{const{load:i}=await n.e(1204).then(n.bind(n,41204));return(0,h.Te)(t),await i({instance:this,supportedTypes:e.supportedTypes,validateItem:e.validateItem,supportsData:e.supportsData,layerModuleTypeMap:e.layerModuleTypeMap,populateGroupLayer:e.populateGroupLayer},t)}catch(e){throw(0,h.zf)(e)||c.A.getLogger(this).warn(`Failed to load layer (${this.title}, ${this.id}) portal item (${this.portalItem.id})\n  ${e}`),e}}async finishLoadEditablePortalLayer(e){this._set("userHasEditingPrivileges",await this._fetchUserHasEditingPrivileges(e).catch(e=>((0,h.QP)(e),!0)))}async setUserPrivileges(e,t){if(!r.A.userPrivilegesApplied)return this.finishLoadEditablePortalLayer(t);if(this.url)try{const{features:{edit:n,fullEdit:i},content:{updateItem:r}}=await this._fetchUserPrivileges(e,t);this._set("userHasEditingPrivileges",n),this._set("userHasFullEditingPrivileges",i),this._set("userHasUpdateItemPrivileges",r)}catch(e){(0,h.QP)(e)}}async _fetchUserPrivileges(e,t){let n=this.portalItem;if(!e||!n||!n.loaded||n.sourceUrl)return this._fetchFallbackUserPrivileges(t);const i=!s.id?.findCredential(this.url),r=e===n.id;if(r&&n.portal.user)return this._getUserPrivileges(n,i);let o,a;if(r)o=n.portal.url;else try{o=await(0,y.wI)(this.url,t)}catch(e){(0,h.QP)(e)}if(!o||!(0,d.b8)(o,n.portal.url))return this._fetchFallbackUserPrivileges(t);try{const e=null!=t?t.signal:null;a=await(s.id?.getCredential(`${o}/sharing`,{prompt:!1,signal:e}))}catch(e){(0,h.QP)(e)}const l=!0,c=!1,u=!1;if(!a)return{features:{edit:l,fullEdit:c},content:{updateItem:u}};try{if(r?await n.reload():(n=new _.default({id:e,portal:{url:o}}),await n.load(t)),n.portal.user)return this._getUserPrivileges(n,i)}catch(e){(0,h.QP)(e)}return{features:{edit:l,fullEdit:c},content:{updateItem:u}}}_getUserPrivileges(e,t){const n=(0,w.It)(e);return t&&(n.features.edit=!0),n}async _fetchFallbackUserPrivileges(e){let t=!0;try{t=await this._fetchUserHasEditingPrivileges(e)}catch(e){(0,h.QP)(e)}return{features:{edit:t,fullEdit:!1},content:{updateItem:!1}}}async _fetchUserHasEditingPrivileges(e){const t=this.url?s.id?.findCredential(this.url):null;if(!t)return!0;const n=M.credential===t?M.user:await this._fetchEditingUser(e);return M.credential=t,M.user=n,null==n?.privileges||n.privileges.includes("features:user:edit")}async _fetchEditingUser(e){const t=this.portalItem?.portal?.user;if(t)return t;const n=s.id?.findServerInfo(this.url??"");if(!n?.owningSystemUrl)return null;const i=`${n.owningSystemUrl}/sharing/rest`,r=x.A.getDefault();if(r&&r.loaded&&(0,d.S8)(r.restUrl)===(0,d.S8)(i))return r.user;const l=`${i}/community/self`,c=null!=e?e.signal:null,u=await(0,a.Ke)((0,o.A)(l,{authMode:"no-prompt",query:{f:"json"},signal:c}));return u.ok?v.A.fromJSON(u.value.data):null}read(e,t){t&&(t.layer=this),super.read(e,t)}write(e,t){const n=t?.portal,i=this.portalItem?.id&&(this.portalItem.portal||x.A.getDefault());return n&&i&&!(0,d.ut)(i.restUrl,n.restUrl)?(t.messages&&t.messages.push(new l.A("layer:cross-portal",`The layer '${this.title} (${this.id})' cannot be persisted because it refers to an item on a different portal than the one being saved to. To save, set layer.portalItem to null or save to the same portal as the item associated with the layer`,{layer:this})),null):super.write(e,{...t,layer:this})}};return(0,i.Cg)([(0,p.MZ)({type:_.default})],P.prototype,"portalItem",null),(0,i.Cg)([(0,m.w)("web-document","portalItem",["itemId"])],P.prototype,"readPortalItem",null),(0,i.Cg)([(0,g.K)("web-document","portalItem",{itemId:{type:String}})],P.prototype,"writePortalItem",null),(0,i.Cg)([(0,p.MZ)({clonable:!1})],P.prototype,"resourceReferences",void 0),(0,i.Cg)([(0,p.MZ)({type:Boolean,readOnly:!0})],P.prototype,"userHasEditingPrivileges",void 0),(0,i.Cg)([(0,p.MZ)({type:Boolean,readOnly:!0})],P.prototype,"userHasFullEditingPrivileges",void 0),(0,i.Cg)([(0,p.MZ)({type:Boolean,readOnly:!0})],P.prototype,"userHasUpdateItemPrivileges",void 0),P=(0,i.Cg)([(0,f.$)("esri.layers.mixins.PortalLayer")],P),P},M={credential:null,user:null}},10407:(e,t,n)=>{n.d(t,{It:()=>p,LG:()=>o,OM:()=>c,Sm:()=>u,Y:()=>a,bK:()=>l,mm:()=>d,sQ:()=>h});var i=n(91218),r=n(16930),s=n(28735);function o(e,t){if(!a(e,t)){const n=e.typeKeywords;n?n.push(t):e.typeKeywords=[t]}}function a(e,t){return!!e.typeKeywords?.includes(t)}function l(e){return a(e,d.HOSTED_SERVICE)}function c(e,t){const n=e.typeKeywords;if(n){const e=n.indexOf(t);e>-1&&n.splice(e,1)}}function u(e,t,n){n?o(e,t):c(e,t)}async function h(e){const t=e.clone().normalize();let n;if(t.length>1)for(const e of t)n?e.width>n.width&&(n=e):n=e;else n=t[0];return async function(e){const t=e.spatialReference;if(t.isWGS84)return e.clone();if(t.isWebMercator)return(0,s.ci)(e);const n=r.A.WGS84;return await(0,i.initializeProjection)(t,n),(0,i.project)(e,n)}(n)}const d={CHARTS:"Charts",DYNAMIC:"Dynamic",DEVELOPER_BASEMAP:"DeveloperBasemap",GROUP_LAYER_MAP:"Map",HOSTED_SERVICE:"Hosted Service",JSAPI:"ArcGIS API for JavaScript",LOCAL_SCENE:"ViewingMode-Local",METADATA:"Metadata",MULTI_LAYER:"Multilayer",ORIENTED_IMAGERY_LAYER:"OrientedImageryLayer",SINGLE_LAYER:"Singlelayer",SUBTYPE_GROUP_LAYER:"SubtypeGroupLayer",SUBTYPE_GROUP_TABLE:"SubtypeGroupTable",TABLE:"Table",TILED_IMAGERY:"Tiled Imagery"};function p(e){const{portal:t,isOrgItem:n,itemControl:i}=e,r=t.user?.privileges;let s=!r||r.includes("features:user:edit"),o=!!n&&!!r?.includes("features:user:fullEdit");const a="update"===i||"admin"===i;return a?o=s=!0:o&&(s=!0),{features:{edit:s,fullEdit:o},content:{updateItem:a}}}},11006:(e,t,n)=>{function i(e,t,n,i,s){r(e,t,n||0,i||e.length-1,s||o)}function r(e,t,n,i,o){for(;i>n;){if(i-n>600){var a=i-n+1,l=t-n+1,c=Math.log(a),u=.5*Math.exp(2*c/3),h=.5*Math.sqrt(c*u*(a-u)/a)*(l-a/2<0?-1:1);r(e,t,Math.max(n,Math.floor(t-l*u/a+h)),Math.min(i,Math.floor(t+(a-l)*u/a+h)),o)}var d=e[t],p=n,m=i;for(s(e,n,t),o(e[i],d)>0&&s(e,n,i);p<m;){for(s(e,p,m),p++,m--;o(e[p],d)<0;)p++;for(;o(e[m],d)>0;)m--}0===o(e[n],d)?s(e,n,m):s(e,++m,i),m<=t&&(n=m+1),t<=m&&(i=m-1)}}function s(e,t,n){var i=e[t];e[t]=e[n],e[n]=i}function o(e,t){return e<t?-1:e>t?1:0}n.d(t,{q:()=>i})},13069:(e,t,n)=>{n.d(t,{AG:()=>a,lk:()=>r,vD:()=>o,yS:()=>s});const i="randomUUID"in crypto;function r(){if(i)return crypto.randomUUID();const e=crypto.getRandomValues(new Uint16Array(8));e[3]=4095&e[3]|16384,e[4]=16383&e[4]|32768;const t=t=>e[t].toString(16).padStart(4,"0");return t(0)+t(1)+"-"+t(2)+"-"+t(3)+"-"+t(4)+"-"+t(5)+t(6)+t(7)}function s(){return`{${r().toUpperCase()}}`}function o(){return`{${r()}}`}function a(e){const t=e.toUpperCase();return e.startsWith("{")?t:`{${t}}`}},16494:(e,t,n)=>{n.d(t,{Nd:()=>a,W5:()=>o});var i=n(37330);const r=["dd","dl","dt","h1","h2","h3","h4","h5","h6","sub","sup","animate","animatetransform","circle","clippath","defs","ellipse","g","image","line","lineargradient","marker","mask","path","pattern","polygon","polyline","radialgradient","rect","stop","svg","switch","symbol","text","textpath","tspan","use"].reduce((e,t)=>(e[t]=[],e),{}),s=["align","alink","alt","bgcolor","border","cellpadding","cellspacing","class","color","cols","colspan","coords","d","dir","face","height","hspace","ismap","lang","marginheight","marginwidth","multiple","nohref","noresize","noshade","nowrap","ref","rel","rev","rows","rowspan","scrolling","shape","span","summary","tabindex","title","usemap","valign","value","vlink","vspace","width"],o=new i.I({whiteList:r,onTagAttr:(e,t,n)=>{const i=`${t}="${n}"`;if(s.includes(t))return i},stripIgnoreTag:!0,stripIgnoreTagBody:["script","style"]},!0),a=new i.I({whiteList:{br:[]},stripIgnoreTag:!0,escapeHtml:e=>e},!1)},19647:(e,t,n)=>{n.r(t),n.d(t,{default:()=>et});var i=n(31635),r=n(7762),s=n(49186),o=n(53966),a=n(92071),l=n(74887),c=n(10107),u=n(79901),h=(n(44208),n(87811),n(36005)),d=n(64108),p=n(43937),m=n(4146),f=n(63074),g=n(16131),y=n(8303),x=n(25036),_=n(25482),v=n(77690),w=n(29242),P=n(37585),M=n(38954);const I=(0,n(51850).vt)(),b=(0,w.vt)(),A=(0,w.vt)(),C=(0,w.vt)();function R(e,t,n){return(0,M.j)(I,t[0],t[1],1),(0,M.o)(I,I,(0,v.mg)(b,n)),0===I[2]?(0,P.hZ)(e,I[0],I[1]):(0,P.hZ)(e,I[0]/I[2],I[1]/I[2])}function S(e,t,n){return O(A,t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]),O(C,n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7]),(0,v.lw)(e,(0,v.KC)(A,A),C),0!==e[8]&&(e[0]/=e[8],e[1]/=e[8],e[2]/=e[8],e[3]/=e[8],e[4]/=e[8],e[5]/=e[8],e[6]/=e[8],e[7]/=e[8],e[8]/=e[8]),e}function O(e,t,n,i,r,s,o,a,l){(0,v.hZ)(e,t,i,s,n,r,o,1,1,1),(0,M.j)(I,a,l,1),(0,v.KC)(b,e);const[c,u,h]=(0,M.o)(I,I,(0,v.mg)(b,b));return(0,v.hZ)(b,c,0,0,0,u,0,0,0,h),(0,v.lw)(e,b,e)}var E=n(90629),L=n(48163),B=n(86738),T=n(39829),Z=n(91218),j=n(16930),Y=n(56560),U=n(69540);let H=class extends U.Pw{projectOrWarn(e,t){if(null==e)return e;const{geometry:n,pending:i}=(0,Z.projectOrLoad)(e,t);return i?null:i||n?n:(o.A.getLogger(this).warn("geometry could not be projected to the spatial reference",{georeference:this,geometry:e,sourceSpatialReference:e.spatialReference,targetSpatialReference:t}),null)}};H=(0,i.Cg)([(0,d.$)("esri.layers.support.GeoreferenceBase")],H);const X=(0,w.vt)(),N=(0,L.vt)();let $=class extends _.o{};(0,i.Cg)([(0,c.MZ)({type:Number,json:{write:{isRequired:!0}}})],$.prototype,"x",void 0),(0,i.Cg)([(0,c.MZ)({type:Number,json:{write:{isRequired:!0}}})],$.prototype,"y",void 0),$=(0,i.Cg)([(0,d.$)("esri.layers.support.ControlPointsGeoreference.ControlPointJSONType")],$);let z=class extends((0,_.T)(H)){constructor(e){super(e),this.controlPoints=null,this.height=0,this.type="control-points",this.width=0}readControlPoints(e,t){const n=j.A.fromJSON(t.spatialReference),i=(0,w.fA)(...t.coefficients,1);return e.map(e=>((0,P.hZ)(N,e.x,e.y),R(N,N,i),{sourcePoint:e,mapPoint:new B.A({x:N[0],y:N[1],spatialReference:n})}))}writeControlPoints(e,t,n,i){if(null==this.transform){const e=new s.A("web-document-write:invalid-georeference","Invalid 'controlPoints', 'width', 'height' configuration. Make sure the parent media element is loaded i.e. the ImageElement or VideoElement set as 'MediaLayer.source'.",{layer:i?.layer,georeference:this});return void(i?.messages?i.messages.push(e):o.A.getLogger(this).error(e.name,e.message))}null!=e&&V(e[0])&&(t.controlPoints=e.map(e=>{const t=e.sourcePoint;return{x:t.x,y:t.y}}),t.spatialReference=e[0].mapPoint.spatialReference.toJSON(),t.coefficients=this.transform.slice(0,8))}get coords(){if(null==this.controlPoints)return null;const e=this._updateTransform(X);if(null==e||!V(this.controlPoints[0]))return null;const t=this.controlPoints[0].mapPoint.spatialReference;return function(e,t,n,i){const r=(0,L.fA)(0,n),s=(0,L.fA)(0,0),o=(0,L.fA)(t,0),a=(0,L.fA)(t,n);return R(r,r,e),R(s,s,e),R(o,o,e),R(a,a,e),new T.A({rings:[[r,s,o,a,r]],spatialReference:i})}(e,this.width,this.height,t)}set coords(e){if(null==this.controlPoints||!V(this.controlPoints[0]))return;const t=this.controlPoints[0].mapPoint.spatialReference;if(null==(e=this.projectOrWarn(e,t)))return;const{width:n,height:i}=this,{rings:[[r,s,o,a]]}=e,l=new Y.A({sourcePoint:(0,E.tc)(0,i),mapPoint:new B.A({x:r[0],y:r[1],spatialReference:t})}),c=new Y.A({sourcePoint:(0,E.tc)(0,0),mapPoint:new B.A({x:s[0],y:s[1],spatialReference:t})}),u=new Y.A({sourcePoint:(0,E.tc)(n,0),mapPoint:new B.A({x:o[0],y:o[1],spatialReference:t})}),h=new Y.A({sourcePoint:(0,E.tc)(n,i),mapPoint:new B.A({x:a[0],y:a[1],spatialReference:t})});V(l)&&V(c)&&V(u)&&V(h)&&(te(X,l,c,u,h),this.controlPoints=this.controlPoints.map(({sourcePoint:e})=>((0,P.hZ)(N,e.x,e.y),R(N,N,X),{sourcePoint:e,mapPoint:new B.A({x:N[0],y:N[1],spatialReference:t})})))}get inverseTransform(){return null==this.transform?null:(0,v.B8)((0,w.vt)(),this.transform)}get transform(){return this._updateTransform()}toMap(e){if(null==e||null==this.transform||null==this.controlPoints||!V(this.controlPoints[0]))return null;(0,P.hZ)(N,e.x,e.y);const t=this.controlPoints[0].mapPoint.spatialReference;return R(N,N,this.transform),new B.A({x:N[0],y:N[1],spatialReference:t})}toSource(e){if(null==e||null==this.inverseTransform||null==this.controlPoints||!V(this.controlPoints[0]))return null;const t=this.controlPoints[0].mapPoint.spatialReference;return e=e.normalize(),null==(e=(0,Z.projectOrLoad)(e,t).geometry)?null:((0,P.hZ)(N,e.x,e.y),R(N,N,this.inverseTransform),(0,E.tc)(N[0],N[1]))}toSourceNormalized(e){const t=this.toSource(e);return null!=t&&(t.x/=this.width,t.y/=this.height),t}_updateTransform(e){const{controlPoints:t,width:n,height:i}=this;if(!(null!=t&&n>0&&i>0))return null;const[r,s,o,a]=t;if(!V(r))return null;const l=r.mapPoint.spatialReference,c=this._projectControlPoint(s,l),u=this._projectControlPoint(o,l),h=this._projectControlPoint(a,l);if(!c.valid||!u.valid||!h.valid)return null;if(!V(c.controlPoint))return null;null==e&&(e=(0,w.vt)());let d=null;return d=V(u.controlPoint)&&V(h.controlPoint)?te(e,r,c.controlPoint,u.controlPoint,h.controlPoint):V(u.controlPoint)?function(e,t,n,i){return ee(k,F,t),ee(G,q,n),ee(W,K,i),(0,P.Cc)(D,k,G,.5),(0,P.e$)(D,W,D,Math.PI),(0,P.Cc)(J,F,q,.5),(0,P.e$)(J,K,J,Math.PI),se(e,k,G,W,D,F,q,K,J)}(e,r,c.controlPoint,u.controlPoint):function(e,t,n){return ee(k,F,t),ee(G,q,n),(0,P.e$)(W,G,k,Q),(0,P.e$)(D,k,G,Q),(0,P.e$)(K,q,F,-Q),(0,P.e$)(J,F,q,-Q),se(e,k,G,W,D,F,q,K,J)}(e,r,c.controlPoint),d.every(e=>0===e)?null:d}_projectControlPoint(e,t){if(!V(e))return{valid:!0,controlPoint:e};const{sourcePoint:n,mapPoint:i}=e,{geometry:r,pending:s}=(0,Z.projectOrLoad)(i,t);return s?{valid:!1,controlPoint:null}:s||r?{valid:!0,controlPoint:new Y.A({sourcePoint:n,mapPoint:r})}:(o.A.getLogger(this).warn("map point could not be projected to the spatial reference",{georeference:this,controlPoint:e,sourceSpatialReference:i.spatialReference,targetSpatialReference:t}),{valid:!1,controlPoint:null})}};function V(e){return null!=e?.sourcePoint&&null!=e.mapPoint}(0,i.Cg)([(0,c.MZ)({type:[Y.A],json:{write:{allowNull:!1,isRequired:!0,target:{controlPoints:{type:[$],isRequired:!0},coefficients:{type:[Number],isRequired:!0},spatialReference:{type:j.A,isRequired:!0}}}}})],z.prototype,"controlPoints",void 0),(0,i.Cg)([(0,h.w)("controlPoints")],z.prototype,"readControlPoints",null),(0,i.Cg)([(0,p.K)("controlPoints")],z.prototype,"writeControlPoints",null),(0,i.Cg)([(0,c.MZ)({clonable:!1})],z.prototype,"coords",null),(0,i.Cg)([(0,c.MZ)({type:Number,nonNullable:!0,json:{write:{isRequired:!0}}})],z.prototype,"height",void 0),(0,i.Cg)([(0,c.MZ)({readOnly:!0})],z.prototype,"inverseTransform",null),(0,i.Cg)([(0,c.MZ)({readOnly:!0})],z.prototype,"transform",null),(0,i.Cg)([(0,c.MZ)({type:Number,nonNullable:!0,json:{write:{isRequired:!0}}})],z.prototype,"width",void 0),z=(0,i.Cg)([(0,d.$)("esri.layers.support.ControlPointsGeoreference")],z);const k=(0,L.vt)(),G=(0,L.vt)(),W=(0,L.vt)(),D=(0,L.vt)(),F=(0,L.vt)(),q=(0,L.vt)(),K=(0,L.vt)(),J=(0,L.vt)(),Q=Math.PI/2;function ee(e,t,n){(0,P.hZ)(e,n.sourcePoint.x,n.sourcePoint.y),(0,P.hZ)(t,n.mapPoint.x,n.mapPoint.y)}function te(e,t,n,i,r){return ee(k,F,t),ee(G,q,n),ee(W,K,i),ee(D,J,r),se(e,k,G,W,D,F,q,K,J)}const ne=new Array(8).fill(0),ie=new Array(8).fill(0);function re(e,t,n,i,r){return e[0]=t[0],e[1]=t[1],e[2]=n[0],e[3]=n[1],e[4]=i[0],e[5]=i[1],e[6]=r[0],e[7]=r[1],e}function se(e,t,n,i,r,s,o,a,l){return S(e,re(ne,t,n,i,r),re(ie,s,o,a,l))}var oe=n(78888),ae=n(21287),le=n(84952),ce=n(13069),ue=n(4902),he=n(92474),de=n(35666),pe=n(5443),me=n(21325);const fe=(0,L.vt)();let ge=class extends H{constructor(e){super(e),this.bottomLeft=null,this.bottomRight=null,this.topLeft=null,this.topRight=null,this.type="corners"}get coords(){let{topLeft:e,topRight:t,bottomLeft:n,bottomRight:i}=this;if(null==e||null==t||null==n||null==i)return null;const r=e.spatialReference;return t=this.projectOrWarn(t,r),n=this.projectOrWarn(n,r),i=this.projectOrWarn(i,r),null==t||null==n||null==i?null:new T.A({rings:[[[n.x,n.y],[e.x,e.y],[t.x,t.y],[i.x,i.y],[n.x,n.y]]],spatialReference:r})}set coords(e){const{topLeft:t}=this;if(null==t)return;const n=t.spatialReference;if(null==(e=this.projectOrWarn(e,n)))return;const{rings:[[i,r,s,o]]}=e;this.bottomLeft=new B.A({x:i[0],y:i[1],spatialReference:n}),this.topLeft=new B.A({x:r[0],y:r[1],spatialReference:n}),this.topRight=new B.A({x:s[0],y:s[1],spatialReference:n}),this.bottomRight=new B.A({x:o[0],y:o[1],spatialReference:n})}toSourceNormalized(e){const{topLeft:t,topRight:n,bottomRight:i,bottomLeft:r}=this;if(null==e||null==t||null==n||null==i||null==r)return null;const s=t.spatialReference;e=e.normalize();const o=(0,Z.projectOrLoad)(e,s).geometry;if(null==o)return null;(0,P.hZ)(fe,o.x,o.y);const a=S((0,w.vt)(),[t.x,t.y,r.x,r.y,n.x,n.y,i.x,i.y],[0,0,0,1,1,0,1,1]);return R(fe,fe,a),(0,E.tc)(fe[0],fe[1])}};(0,i.Cg)([(0,c.MZ)({clonable:!1})],ge.prototype,"coords",null),(0,i.Cg)([(0,c.MZ)({type:B.A})],ge.prototype,"bottomLeft",void 0),(0,i.Cg)([(0,c.MZ)({type:B.A})],ge.prototype,"bottomRight",void 0),(0,i.Cg)([(0,c.MZ)({type:B.A})],ge.prototype,"topLeft",void 0),(0,i.Cg)([(0,c.MZ)({type:B.A})],ge.prototype,"topRight",void 0),ge=(0,i.Cg)([(0,d.$)("esri.layers.support.CornersGeoreference")],ge);const ye=ge;var xe=n(34727),_e=n(34304);let ve=class extends H{constructor(e){super(e),this.extent=null,this.rotation=0,this.type="extent-and-rotation"}get coords(){if(null==this.extent)return null;const{xmin:e,ymin:t,xmax:n,ymax:i,spatialReference:r}=this.extent;let s;if(this.rotation){const{x:r,y:o}=this.extent.center,a=we(r,o,this.rotation);s=[a(e,t),a(e,i),a(n,i),a(n,t)],s.push(s[0])}else s=[[e,t],[e,i],[n,i],[n,t],[e,t]];return new T.A({rings:[s],spatialReference:r})}set coords(e){if(null==e||null==this.extent)return;const t=this.extent.spatialReference;if(e=this.projectOrWarn(e,t),null==e?.extent)return;const{rings:[[n,i,r]],extent:{center:{x:s,y:o}}}=e,a=(0,xe.KJ)(Math.PI/2-Math.atan2(i[1]-n[1],i[0]-n[0])),l=we(s,o,-a),[c,u]=l(n[0],n[1]),[h,d]=l(r[0],r[1]);this.extent=new pe.A({xmin:c,ymin:u,xmax:h,ymax:d,spatialReference:t}),this.rotation=a}toSourceNormalized(e){const{extent:t,rotation:n}=this;if(null==e||null==t)return null;const{xmin:i,ymin:r,xmax:s,ymax:o,center:a,spatialReference:l}=t;e=e.normalize();const c=(0,Z.projectOrLoad)(e,l).geometry;if(null==c)return null;let u=c.x,h=c.y;return n&&([u,h]=we(a.x,a.y,-n)(u,h)),(0,E.tc)((0,xe.hs)(u,i,s,0,1),(0,xe.hs)(h,o,r,0,1))}};function we(e,t,n){const i=(0,_e.DF)(n),r=Math.cos(i),s=Math.sin(i);return(n,i)=>[r*(n-e)+s*(i-t)+e,r*(i-t)-s*(n-e)+t]}function Pe(e,t){const n=(0,de.aB)(t);return function(e){return"media"===e?.type}(e)&&!!e.portalItem&&null!=n&&n>3}function Me(e,t,n){return{enabled:!Pe(n?.layer,n?.origin),ignoreOrigin:!0}}(0,i.Cg)([(0,c.MZ)({clonable:!1})],ve.prototype,"coords",null),(0,i.Cg)([(0,c.MZ)({type:pe.A})],ve.prototype,"extent",void 0),(0,i.Cg)([(0,c.MZ)({type:Number})],ve.prototype,"rotation",void 0),ve=(0,i.Cg)([(0,d.$)("esri.layers.support.ExtentAndRotationGeoreference")],ve);const Ie={json:{name:"url",type:String,write:{overridePolicy:Me}}},be={readOnly:!0,json:{read:!1,write:{target:"mediaType",overridePolicy:Me}}},Ae={types:{key:"type",base:H,typeMap:{"control-points":z,corners:ye,"extent-and-rotation":ve}},json:{types:{key:"type",base:H,typeMap:{"control-points":z}},write:{overridePolicy:()=>({enabled:!0,ignoreOrigin:!0})}}};let Ce=class extends((0,ue.PH)((0,a.P)(he.x_))){constructor(e){super(e),this.georeference=null,this.opacity=1}readGeoreference(e){return z.fromJSON(e)}writeGeoreference(e,t,n,i){const r=i?.resources?.pendingOperations,a=()=>{const r=function(e,t,n){if(!e||"control-points"===e.type)return e;const{coords:i}=e;if(5!==i?.rings[0]?.length)return null;const[r,s,o,a]=i.rings[0],{spatialReference:l}=i;return new z({controlPoints:[new Y.A({mapPoint:new B.A({x:r[0],y:r[1],spatialReference:l}),sourcePoint:(0,E.tc)(0,n)}),new Y.A({mapPoint:new B.A({x:s[0],y:s[1],spatialReference:l}),sourcePoint:(0,E.tc)(0,0)}),new Y.A({mapPoint:new B.A({x:o[0],y:o[1],spatialReference:l}),sourcePoint:(0,E.tc)(t,0)}),new Y.A({mapPoint:new B.A({x:a[0],y:a[1],spatialReference:l}),sourcePoint:(0,E.tc)(t,n)})],width:t,height:n})}(this.georeference,this.contentWidth,this.contentHeight);if(r){if("control-points"!==e.type&&o.A.getLogger(this).warn(`only georeference of type 'control-points' may be persisted. The georeference of type '${e.type}' has been automatically converted.`),4!==r.controlPoints?.length&&i?.messages)return void i.messages.push(new s.A("property:unsupported","only 'control-points' georeference with 4 control points may be persisted."));t[n]=r.write({},i)}};if("control-points"!==e.type&&!this.loaded&&r)return t[n]={},void r.push(this.load().then(a));a()}get contentWidth(){return 0}get contentHeight(){return 0}toSource(e){const{georeference:t,contentWidth:n,contentHeight:i}=this;if(null==e||null==t||0===n||0===i)return null;const r=t.toSourceNormalized(e);return null==r?null:(r.x*=n,r.y*=i,r)}};(0,i.Cg)([(0,c.MZ)(Ae)],Ce.prototype,"georeference",void 0),(0,i.Cg)([(0,h.w)("georeference")],Ce.prototype,"readGeoreference",null),(0,i.Cg)([(0,p.K)("georeference")],Ce.prototype,"writeGeoreference",null),(0,i.Cg)([(0,c.MZ)({json:{read:!1,write:!1}})],Ce.prototype,"opacity",void 0),Ce=(0,i.Cg)([(0,d.$)("esri.layers.support.MediaElementBase")],Ce);var Re=n(85648);const Se=Symbol("ImageElementInstance"),Oe=Symbol("VideoElementInstance");function Ee(e){return function(e){return null!=e&&"object"==typeof e&&Se in e}(e)||function(e){return null!=e&&"object"==typeof e&&Oe in e}(e)}var Le,Be=n(97159);let Te=class extends Ce{static{Le=Se}constructor(e){super(e),this.animationOptions=null,this.content=null,this.image=null,this.type="image",this[Le]=!0,this.image=null}load(){const e=this.image;if("string"==typeof e){const t=(0,ae.M5)(e).then(e=>{this._set("content",e)});this.addResolvingPromise(t)}else if(e instanceof HTMLImageElement){const t=e.decode().then(()=>{this._set("content",e)});this.addResolvingPromise(t)}else e?this._set("content",e):this.addResolvingPromise(Promise.reject(new s.A("image-element:invalid-image-type","Invalid image type",{image:e})));return Promise.resolve(this)}get contentWidth(){return null==this.content?0:this.content instanceof HTMLImageElement?this.content.naturalWidth:this.content.width}get contentHeight(){return null==this.content?0:this.content instanceof HTMLImageElement?this.content.naturalHeight:this.content.height}readImage(e,t,n){return(0,Be.f)(t.url,n)}writeImage(e,t,n,i){if(null==e)return;const r=i?.portalItem,s=i?.resources;if(!r||!s)return void("string"==typeof e&&(t[n]=(0,Be.t)(e,i)));const o=function(e){return"string"==typeof e&&!(0,le.DB)(e)&&!(0,le.w8)(e)}(e)?e:null;if(o){if(null==(0,Be.i)(o))return void(t[n]=o);const e=(0,Be.t)(o,{...i,verifyItemRelativeUrls:i?.verifyItemRelativeUrls?{writtenUrls:i.verifyItemRelativeUrls.writtenUrls,rootPath:void 0}:void 0},1);if(r&&e&&!(0,le.oP)(e))return s.toKeep.push({resource:r.resourceFromPath(e),compress:!1}),void(t[n]=e)}t[n]="<pending>",s.pendingOperations.push(async function(e){return"string"==typeof e?(0,le.DB)(e)?(0,le.N9)(e):(await(0,oe.A)(e,{responseType:"blob"})).data:new Promise(t=>function(e){if(e instanceof HTMLCanvasElement)return e;const t=e instanceof HTMLImageElement?e.naturalWidth:e.width,n=e instanceof HTMLImageElement?e.naturalHeight:e.height,i=document.createElement("canvas"),r=i.getContext("2d");return i.width=t,i.height=n,e instanceof HTMLImageElement?r.drawImage(e,0,0,e.width,e.height):e instanceof ImageData&&r.putImageData(e,0,0),i}(e).toBlob(t))}(e).then(e=>{const i=function(e,t){const n=(0,ce.lk)(),i=`${(0,le.fj)("media",n)}.${(0,Re.n)({type:"blob",blob:e})}`;return t.resourceFromPath(i)}(e,r);t[n]=i.itemRelativeUrl,s.toAdd.push({resource:i,content:{type:"blob",blob:e},compress:!1,finish:e=>{this.image=e.url}})}))}};(0,i.Cg)([(0,c.MZ)()],Te.prototype,"animationOptions",void 0),(0,i.Cg)([(0,c.MZ)({readOnly:!0})],Te.prototype,"content",void 0),(0,i.Cg)([(0,c.MZ)({readOnly:!0})],Te.prototype,"contentWidth",null),(0,i.Cg)([(0,c.MZ)({readOnly:!0})],Te.prototype,"contentHeight",null),(0,i.Cg)([(0,c.MZ)(Ie)],Te.prototype,"image",void 0),(0,i.Cg)([(0,h.w)("image",["url"])],Te.prototype,"readImage",null),(0,i.Cg)([(0,p.K)("image")],Te.prototype,"writeImage",null),(0,i.Cg)([(0,c.MZ)(be)],Te.prototype,"type",void 0),Te=(0,i.Cg)([(0,d.$)("esri.layers.support.ImageElement")],Te);var Ze=n(62885),je=n(65529),Ye=n(61893),Ue=n(36708),He=n(19419),Xe=n(12176),Ne=n(6518),$e=n(65008),ze=n(89056);let Ve=class extends $e.A{constructor(e){super(e)}get bounds(){const e=this.coords;return null==e?.extent?null:(0,He.VY)(e.extent)}get coords(){const e=this.element.georeference?.coords;return(0,Z.projectOrLoad)(e,this.spatialReference).geometry}get normalizedCoords(){return T.A.fromJSON((0,ze.jZ)(this.coords))}get normalizedBounds(){const e=null!=this.normalizedCoords?this.normalizedCoords.extent:null;return null!=e?(0,He.VY)(e):null}};(0,i.Cg)([(0,c.MZ)()],Ve.prototype,"spatialReference",void 0),(0,i.Cg)([(0,c.MZ)()],Ve.prototype,"element",void 0),(0,i.Cg)([(0,c.MZ)()],Ve.prototype,"bounds",null),(0,i.Cg)([(0,c.MZ)()],Ve.prototype,"coords",null),(0,i.Cg)([(0,c.MZ)()],Ve.prototype,"normalizedCoords",null),(0,i.Cg)([(0,c.MZ)()],Ve.prototype,"normalizedBounds",null),Ve=(0,i.Cg)([(0,d.$)("esri.layers.support.MediaElementView")],Ve);var ke,Ge=n(16494),We=n(38969);const De=Symbol("canplay");let Fe=class extends Ce{static{ke=Oe}constructor(e){super(e),this.autoplay=!0,this.content=null,this.type="video",this[ke]=!0}load(){const e=this.video;return"string"==typeof e?this.addResolvingPromise(this._preProcessVideoUrl(e).then(async e=>{const t=document.createElement("video");return t.src=Ge.W5.sanitizeUrl((0,le.s2)(e)),t.crossOrigin="anonymous",t.autoplay=this.autoplay,t.muted=!0,t.loop=!0,t.playsInline=!0,this._loadVideo(t).then(()=>{this._set("content",t)})})):e instanceof HTMLVideoElement?this.addResolvingPromise(this._loadVideo(e).then(()=>{this._set("content",e)})):this.addResolvingPromise(Promise.reject(new s.A("video-element:invalid-video-type","Invalid video type",{video:e}))),Promise.resolve(this)}get contentWidth(){return this.content?.videoWidth??0}get contentHeight(){return this.content?.videoHeight??0}get currentTime(){return this.content?.currentTime}set currentTime(e){if(!this.content)return;const t=(0,xe.qE)(e,0,this.content.duration);"fastSeek"in this.content?this.content.fastSeek(t):this.content.currentTime=t,this.content.play().then(()=>{this.content?.pause()}).catch(()=>{})}get duration(){return this.content?.duration}set video(e){"not-loaded"===this.loadStatus?this._set("video",e):o.A.getLogger(this).error("#video","video cannot be changed after the element is loaded.")}writeVideo(e,t,n,i){if(!e)return void(i?.messages&&i.messages.push(new s.A("video-element:unsupported-video","video source is missing")));const r=function(e){return"string"==typeof e&&!(0,le.DB)(e)&&!(0,le.w8)(e)}(e)?e:null;if(!r)return void(i?.messages&&i.messages.push(new s.A("video-element:unsupported-video","video source must be an absolute url")));!(0,le.oP)(r)&&i?.blockedRelativeUrls&&i.blockedRelativeUrls.push(r);const o=(0,le.s2)(r);(0,Be.i)(o)?i?.messages&&i.messages.push(new s.A("video-element:unsupported-video","video source cannot be an item resource")):t[n]=o}async _preProcessVideoUrl(e){if((0,le.zs)(e))return(0,le.yM)(e);try{return await(0,oe.A)(e,{method:"head"}),e}catch{try{return(0,le.yM)(e,!0)}catch{return e}}}async _loadVideo(e){"anonymous"!==e.crossOrigin&&(e.crossOrigin="anonymous",(0,le.w8)(e.src)||(e.src=e.src));try{await(0,We.i)(e,e=>this.addHandles(e,De)),this.autoplay&&await e.play().catch(e=>{throw console.error(e),e})}finally{this.removeHandles(De)}}};(0,i.Cg)([(0,c.MZ)()],Fe.prototype,"autoplay",void 0),(0,i.Cg)([(0,c.MZ)({readOnly:!0})],Fe.prototype,"content",void 0),(0,i.Cg)([(0,c.MZ)({readOnly:!0})],Fe.prototype,"contentWidth",null),(0,i.Cg)([(0,c.MZ)({readOnly:!0})],Fe.prototype,"contentHeight",null),(0,i.Cg)([(0,c.MZ)({type:Number})],Fe.prototype,"currentTime",null),(0,i.Cg)([(0,c.MZ)({type:Number})],Fe.prototype,"duration",null),(0,i.Cg)([(0,c.MZ)(Ie)],Fe.prototype,"video",null),(0,i.Cg)([(0,p.K)("video")],Fe.prototype,"writeVideo",null),(0,i.Cg)([(0,c.MZ)(be)],Fe.prototype,"type",void 0),Fe=(0,i.Cg)([(0,d.$)("esri.layers.support.VideoElement")],Fe);const qe={key:"type",defaultKeyValue:"image",base:Ce,typeMap:{image:Te,video:Fe}},Ke=r.A.ofType(qe);let Je=class extends((0,he.WV)((0,Ye.g)(je.nJ))){constructor(e){super(e),this._index=new Ne.F,this._elementViewsMap=new Map,this._elementsIndexes=new Map,this._elementsChangedHandler=e=>{for(const t of e.removed){const e=this._elementViewsMap.get(t);this._elementViewsMap.delete(t),this._index.delete(e),this.removeHandles(e),e.destroy(),this.notifyChange("fullExtent")}const{spatialReference:t}=this;for(const n of e.added){if(this._elementViewsMap.get(n))continue;const e=new Ve({spatialReference:t,element:n});this._elementViewsMap.set(n,e);const i=(0,Ue.wB)(()=>e.coords,()=>this._updateIndexForElement(e,!1));this._updateIndexForElement(e,!0),this.addHandles(i,e)}this._elementsIndexes.clear(),this.elements.forEach((e,t)=>this._elementsIndexes.set(e,t)),this.emit("refresh")},this.elements=new Ke}async load(e){if((0,l.Te)(e),!this.spatialReference){const e=this.elements.find(e=>null!=e.georeference?.coords);this._set("spatialReference",e?e.georeference.coords.spatialReference:j.A.WGS84)}return this._elementsChangedHandler({added:this.elements.items,removed:[]}),this.addHandles(this.elements.on("change",this._elementsChangedHandler)),this}destroy(){this._index.clear(),this._elementViewsMap.clear(),this._elementsIndexes.clear()}set elements(e){this._set("elements",(0,Ze.V)(e,this._get("elements"),Ke))}get fullExtent(){if("not-loaded"===this.loadStatus)return null;const e=this._index.fullBounds;return null==e?null:new pe.A({xmin:e[0],ymin:e[1],xmax:e[2],ymax:e[3],spatialReference:this.spatialReference})}set spatialReference(e){"not-loaded"===this.loadStatus?this._set("spatialReference",e):o.A.getLogger(this).error("#spatialReference","spatialReference cannot be changed after the source is loaded.")}async queryElements(e,t){await this.load(),await(0,Z.initializeProjection)(e.spatialReference,this.spatialReference,null,t);const n=(0,me.aI)(e.spatialReference,this.spatialReference)?e:(0,Z.project)(e,this.spatialReference);if(!n)return[];const i=n.normalize(),r=[];for(const e of i)this._index.forEachInBounds((0,He.VY)(e),({normalizedCoords:t,element:n})=>{null!=t&&(0,Xe.fA)(e,t)&&r.push(n)});return r.sort((e,t)=>this._elementsIndexes.get(e)-this._elementsIndexes.get(t)),r}hasElement(e){return this.elements.includes(e)}_updateIndexForElement(e,t){const n=e.normalizedBounds,i=this._index.has(e),r=null!=n;this._index.delete(e),r&&this._index.set(e,n),this.notifyChange("fullExtent"),t||(i!==r?this.emit("refresh"):this.emit("change",{element:e.element}))}};(0,i.Cg)([(0,c.MZ)()],Je.prototype,"elements",null),(0,i.Cg)([(0,c.MZ)({readOnly:!0})],Je.prototype,"fullExtent",null),(0,i.Cg)([(0,c.MZ)()],Je.prototype,"spatialReference",null),Je=(0,i.Cg)([(0,d.$)("esri.layers.support.LocalMediaElementSource")],Je);let Qe=class extends((0,f.dM)((0,x.j)((0,g.q)((0,y.A)((0,a.P)(m.A)))))){constructor(e){super(e),this.effectiveSource=null,this.georeference=null,this.copyright=null,this.operationalLayerType="MediaLayer",this.spatialReference=null,this.type="media",this._debouncedSaveOperations=(0,l.sg)(async(e,t,i)=>{const{save:r,saveAs:s}=await n.e(3561).then(n.bind(n,63561));switch(e){case 0:return r(this,t);case 1:return s(this,i,t)}}),this.source=new Je}load(e){return this.addResolvingPromise(this._doLoad(e)),Promise.resolve(this)}async _doLoad(e){await this.loadFromPortal({supportedTypes:["Media Layer"]},e);let t=this.source;if(!t)throw new s.A("media-layer:source-missing","Set 'MediaLayer.source' before loading the layer.");const n=this._getSourceOverride(t,this.georeference);n&&(this.setAtOrigin("source",n,"web-map"),this.setAtOrigin("source",n,"web-scene"),t=n);const i=Ee(t)?new Je({elements:new r.A([t])}):t;this._set("effectiveSource",i),this.spatialReference&&(i.spatialReference=this.spatialReference),await i.load(e),this.spatialReference=i.spatialReference}destroy(){this.effectiveSource?.destroy(),this.effectiveSource!==this.source&&this.source?.destroy()}readGeoreference(e,t){return e&&"itemId"in t&&t.itemId?e:void 0}get fullExtent(){return this.loaded?this.effectiveSource.fullExtent:null}get loaded(){return super.loaded}get source(){return this._get("source")}set source(e){"loaded"!==this.loadStatus&&"failed"!==this.loadStatus?this._set("source",e):o.A.getLogger(this).error("#source","source cannot be changed after the layer is loaded.")}castSource(e){return e?Array.isArray(e)?new Je({elements:new r.A(e)}):e instanceof r.A?new Je({elements:e}):e:null}readSource(e,t,n){if("itemId"in t&&t.itemId)return;const i=this._createSource(t);return i?.read(t,n),i}writeSource(e,t,n,i){if(e&&e instanceof Je){const t=e.elements.length;if(1!==t)return void(i?.messages&&i.messages.push(new s.A("media-layer:unsupported-source",`local media element source can only be persisted if it contains exactly one ImageElement, but it has ${t}.`)));e=e.elements.at(0)}Ee(e)?e.write(t,i):i?.messages&&(e?i.messages.push(new s.A("media-layer:unsupported-source","only media elements of type 'ImageElement' or 'VideoElement' can be persisted")):i.messages.push(new s.A("media-layer:unsupported-source","the media layer is missing a source")))}async save(e){return this._debouncedSaveOperations(0,e)}async saveAs(e,t){return this._debouncedSaveOperations(1,t,e)}_createSource(e){if("mediaType"in e)switch(e.mediaType){case"image":return new Te;case"video":return new Fe}return null}_getSourceOverride(e,t){if(Ee(e)&&3===this.originIdOf("source")&&t&&(5===this.originIdOf("georeference")||4===this.originIdOf("georeference"))){const n=e.toJSON(),i=this._createSource(n);return i.read({...n},{origin:"portal-item"}),i.read({georeference:t},{origin:"web-map"}),i.read({georeference:t},{origin:"web-scene"}),i}return null}};(0,i.Cg)([(0,c.MZ)({readOnly:!0})],Qe.prototype,"effectiveSource",void 0),(0,i.Cg)([(0,c.MZ)({readOnly:!0,json:{read:!1,write:!1,origins:{"web-document":{read:!0}}}})],Qe.prototype,"georeference",void 0),(0,i.Cg)([(0,h.w)("web-document","georeference")],Qe.prototype,"readGeoreference",null),(0,i.Cg)([(0,c.MZ)({type:String})],Qe.prototype,"copyright",void 0),(0,i.Cg)([(0,c.MZ)({readOnly:!0})],Qe.prototype,"fullExtent",null),(0,i.Cg)([(0,c.MZ)({type:["MediaLayer"]})],Qe.prototype,"operationalLayerType",void 0),(0,i.Cg)([(0,c.MZ)({type:["show","hide"]})],Qe.prototype,"listMode",void 0),(0,i.Cg)([(0,c.MZ)({nonNullable:!0,json:{write:{enabled:!0,allowNull:!1,target:{url:{type:String},mediaType:{type:["image","video"]},georeference:{type:z}},overridePolicy(e,t,n){return{enabled:!0,allowNull:!1,ignoreOrigin:Pe(this,n?.origin)&&Ee(e)&&!!e.georeference&&e.originIdOf("georeference")>3}}}}})],Qe.prototype,"source",null),(0,i.Cg)([(0,u.w)("source")],Qe.prototype,"castSource",null),(0,i.Cg)([(0,h.w)("source",["url"])],Qe.prototype,"readSource",null),(0,i.Cg)([(0,p.K)("source")],Qe.prototype,"writeSource",null),(0,i.Cg)([(0,c.MZ)()],Qe.prototype,"spatialReference",void 0),(0,i.Cg)([(0,c.MZ)({readOnly:!0})],Qe.prototype,"type",void 0),Qe=(0,i.Cg)([(0,d.$)("esri.layers.MediaLayer")],Qe);const et=Qe},21287:(e,t,n)=>{n.d(t,{M5:()=>h,eV:()=>u});var i=n(78888),r=n(49186),s=n(74887),o=n(84952),a=n(26306);let l=null,c=!0;function u(e,t,n,i){if(!t||!n)throw new Error("Cannot construct image data without dimensions");if(c)try{return new ImageData(e,t,n)}catch(e){c=!1}const r=function(e,t,n){return n||(l||(l=document.createElement("canvas"),l.width=1,l.height=1),n=l),n.getContext("2d").createImageData(e,t)}(t,n,i);return r.data.set(e,0),r}async function h(e,t){const{arrayBuffer:l,mediaType:c}=await async function(e,t){const n=(0,o.r$)(e);if(n?.isBase64)return{arrayBuffer:(0,a.M)(n.data),mediaType:n.mediaType};const r=await(0,i.A)(e,{responseType:"array-buffer",...t});return{arrayBuffer:r.data,mediaType:r.getHeader?.("Content-Type")??""}}(e,t),u="image/png"===c;if("image/gif"===c){const{isAnimatedGIF:e,parseGif:i}=await n.e(820).then(n.bind(n,10820));if(e(l))return i(l,t)}if(u){const{isAnimatedPNG:e,parseApng:i}=await n.e(2390).then(n.bind(n,22390));if(e(l))return i(l,t)}return async function(e,t){const n=window.URL.createObjectURL(e);try{const{data:e}=await(0,i.A)(n,{...t,responseType:"image"});return e}catch(e){if(!(0,s.zf)(e))throw new r.A("invalid-image",`Could not fetch requested image at ${n}`);throw e}finally{window.URL.revokeObjectURL(n)}}(new Blob([l],{type:c}),t)}},38969:(e,t,n)=>{n.d(t,{i:()=>r});var i=n(37955);function r(e,t){return new Promise((n,r)=>{e.readyState>=HTMLMediaElement.HAVE_CURRENT_DATA?n():(t((0,i.Oo)(e,"canplay",n)),t((0,i.Oo)(e,"error",r)))})}},48163:(e,t,n)=>{function i(){return[0,0]}function r(e){return[e[0],e[1]]}function s(e,t){return[e,t]}function o(){return s(1,1)}function a(){return s(1,0)}function l(){return s(0,1)}n.d(t,{Un:()=>c,fA:()=>s,o8:()=>r,vt:()=>i});const c=o(),u=a(),h=l();Object.freeze(Object.defineProperty({__proto__:null,ONES:c,UNIT_X:u,UNIT_Y:h,ZEROS:[0,0],clone:r,create:i,freeze:function(e,t){return[e,t]},fromArray:function(e,t=[0,0]){const n=Math.min(2,e.length);for(let i=0;i<n;++i)t[i]=e[i];return t},fromValues:s,ones:o,unitX:a,unitY:l,zeros:function(){return[0,0]}},Symbol.toStringTag,{value:"Module"}))},62885:(e,t,n)=>{n.d(t,{H:()=>s,V:()=>r});var i=n(7762);function r(e,t,n=i.A){return t||(t=new n),t===e||t.destroyed||(t.removeAll(),(r=e)&&(Array.isArray(r)||"items"in r&&Array.isArray(r.items))?t.addMany(e):e&&t.add(e)),t;var r}function s(e){return e}},69540:(e,t,n)=>{n.d(t,{OU:()=>u,Pw:()=>h});var i=n(31635),r=n(65008),s=(n(44208),n(4718)),o=(n(53966),n(97768)),a=n(88620),l=n(64108);const c=Symbol("ClonableMixin"),u=e=>{var t;const n=e;let r=class extends n{constructor(){super(...arguments),this[t]=!0}static{t=c}clone(e){const t=(0,a.oY)(this);(0,o.Lw)(t,"unable to clone instance of non-accessor class");const n=t.metadata,i=t.store,r={},l=new Map;for(const t in n){const o=n[t],a=i?.originOf(t),c=o.clonable;if(o.readOnly||!1===c||7!==a&&0!==a&&5!==a&&4!==a)continue;const u=this[t];let h=null;if("function"==typeof c)h=c(u,e);else if("reference"===c)h=u;else if(h=(0,s.TU)(u,e),null!=u&&null==h)continue;0===a?l.set(t,h):r[t]=h}const c=new(0,Object.getPrototypeOf(this).constructor)(r);if(l.size){const e=(0,a.oY)(c)?.store;if(e)for(const[t,n]of l)e.set(t,n,0)}return c}};return r=(0,i.Cg)([(0,l.$)("esri.core.Clonable")],r),r},h=u(r.A)},75503:(e,t,n)=>{n.d(t,{EC:()=>b,wq:()=>a});var i=n(4576),r=n(21818),s=(n(44208),n(15142)),o=n(11006);class a{constructor(e=9,t){this._compareMinX=d,this._compareMinY=p,this._toBBox=e=>e,this._maxEntries=Math.max(4,e||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),t&&("function"==typeof t?this._toBBox=t:this._initFormat(t)),this.clear()}destroy(){this.clear(),w.prune(),P.prune(),M.prune(),I.prune()}all(e){l(this._data,e)}search(e,t){let n=this._data;const i=this._toBBox;if(_(e,n))for(w.clear();n;){for(let r=0,s=n.children.length;r<s;r++){const s=n.children[r],o=n.leaf?i(s):s;_(e,o)&&(n.leaf?t(s):x(e,o)?l(s,t):w.push(s))}n=w.pop()}}collides(e){let t=this._data;const n=this._toBBox;if(!_(e,t))return!1;for(w.clear();t;){for(let i=0,r=t.children.length;i<r;i++){const r=t.children[i],s=t.leaf?n(r):r;if(_(e,s)){if(t.leaf||x(e,s))return!0;w.push(r)}}t=w.pop()}return!1}load(e){if(!e.length)return this;if(e.length<this._minEntries){for(let t=0,n=e.length;t<n;t++)this.insert(e[t]);return this}let t=this._build(e.slice(),0,e.length-1,0);if(this._data.children.length)if(this._data.height===t.height)this._splitRoot(this._data,t);else{if(this._data.height<t.height){const e=this._data;this._data=t,t=e}this._insert(t,this._data.height-t.height-1,!0)}else this._data=t;return this}insert(e){return e&&this._insert(e,this._data.height-1),this}clear(){return this._data=new C([]),this}remove(e){if(!e)return this;let t,n=this._data,s=null,o=0,a=!1;const l=this._toBBox(e);for(M.clear(),I.clear();n||M.length>0;){if(n||(n=M.pop(),s=M.data[M.length-1],o=I.pop()??0,a=!0),n.leaf&&(t=(0,i.qh)(n.children,(0,r.zI)(e),n.children.length,n.indexHint),-1!==t))return n.children.splice(t,1),M.push(n),this._condense(M),this;a||n.leaf||!x(n,l)?s?(o++,n=s.children[o],a=!1):n=null:(M.push(n),I.push(o),o=0,s=n,n=n.children[0])}return this}toJSON(){return this._data}fromJSON(e){return this._data=e,this}_build(e,t,n,i){const r=n-t+1;let s=this._maxEntries;if(r<=s){const i=new C(e.slice(t,n+1));return c(i,this._toBBox),i}i||(i=Math.ceil(Math.log(r)/Math.log(s)),s=Math.ceil(r/s**(i-1)));const o=new R([]);o.height=i;const a=Math.ceil(r/s),l=a*Math.ceil(Math.sqrt(s));v(e,t,n,l,this._compareMinX);for(let r=t;r<=n;r+=l){const t=Math.min(r+l-1,n);v(e,r,t,a,this._compareMinY);for(let n=r;n<=t;n+=a){const r=Math.min(n+a-1,t);o.children.push(this._build(e,n,r,i-1))}}return c(o,this._toBBox),o}_insert(e,t,n){const i=this._toBBox,r=n?e:i(e);M.clear();const s=function(e,t,n,i){for(;i.push(t),!0!==t.leaf&&i.length-1!==n;){let n,i=1/0,r=1/0;for(let s=0,o=t.children.length;s<o;s++){const o=t.children[s],a=m(o),l=g(e,o)-a;l<r?(r=l,i=a<i?a:i,n=o):l===r&&a<i&&(i=a,n=o)}t=n||t.children[0]}return t}(r,this._data,t,M);for(s.children.push(e),h(s,r);t>=0&&M.data[t].children.length>this._maxEntries;)this._split(M,t),t--;!function(e,t,n){for(let i=n;i>=0;i--)h(t.data[i],e)}(r,M,t)}_split(e,t){const n=e.data[t],i=n.children.length,r=this._minEntries;this._chooseSplitAxis(n,r,i);const s=this._chooseSplitIndex(n,r,i);if(!s)return;const o=n.children.splice(s,n.children.length-s),a=n.leaf?new C(o):new R(o);a.height=n.height,c(n,this._toBBox),c(a,this._toBBox),t?e.data[t-1].children.push(a):this._splitRoot(n,a)}_splitRoot(e,t){this._data=new R([e,t]),this._data.height=e.height+1,c(this._data,this._toBBox)}_chooseSplitIndex(e,t,n){let i,r,s;i=r=1/0;for(let o=t;o<=n-t;o++){const t=u(e,0,o,this._toBBox),a=u(e,o,n,this._toBBox),l=y(t,a),c=m(t)+m(a);l<i?(i=l,s=o,r=c<r?c:r):l===i&&c<r&&(r=c,s=o)}return s}_chooseSplitAxis(e,t,n){const i=e.leaf?this._compareMinX:d,r=e.leaf?this._compareMinY:p;this._allDistMargin(e,t,n,i)<this._allDistMargin(e,t,n,r)&&e.children.sort(i)}_allDistMargin(e,t,n,i){e.children.sort(i);const r=this._toBBox,s=u(e,0,t,r),o=u(e,n-t,n,r);let a=f(s)+f(o);for(let i=t;i<n-t;i++){const t=e.children[i];h(s,e.leaf?r(t):t),a+=f(s)}for(let i=n-t-1;i>=t;i--){const t=e.children[i];h(o,e.leaf?r(t):t),a+=f(o)}return a}_condense(e){for(let t=e.length-1;t>=0;t--){const n=e.data[t];if(0===n.children.length)if(t>0){const r=e.data[t-1],s=r.children;s.splice((0,i.qh)(s,n,s.length,r.indexHint),1)}else this.clear();else c(n,this._toBBox)}}_initFormat(e){const t=["return a"," - b",";"];this._compareMinX=new Function("a","b",t.join(e[0])),this._compareMinY=new Function("a","b",t.join(e[1])),this._toBBox=new Function("a","return {minX: a"+e[0]+", minY: a"+e[1]+", maxX: a"+e[2]+", maxY: a"+e[3]+"};")}}function l(e,t){let n=e;for(P.clear();n;){if(!0===n.leaf)for(const e of n.children)t((0,r.zI)(e));else P.pushArray(n.children);n=P.pop()??null}}function c(e,t){u(e,0,e.children.length,t,e)}function u(e,t,n,i,r){r||(r=new C([])),r.minX=1/0,r.minY=1/0,r.maxX=-1/0,r.maxY=-1/0;for(let s,o=t;o<n;o++)s=e.children[o],h(r,e.leaf?i(s):s);return r}function h(e,t){e.minX=Math.min(e.minX,t.minX),e.minY=Math.min(e.minY,t.minY),e.maxX=Math.max(e.maxX,t.maxX),e.maxY=Math.max(e.maxY,t.maxY)}function d(e,t){return e.minX-t.minX}function p(e,t){return e.minY-t.minY}function m(e){return(e.maxX-e.minX)*(e.maxY-e.minY)}function f(e){return e.maxX-e.minX+(e.maxY-e.minY)}function g(e,t){return(Math.max(t.maxX,e.maxX)-Math.min(t.minX,e.minX))*(Math.max(t.maxY,e.maxY)-Math.min(t.minY,e.minY))}function y(e,t){const n=Math.max(e.minX,t.minX),i=Math.max(e.minY,t.minY),r=Math.min(e.maxX,t.maxX),s=Math.min(e.maxY,t.maxY);return Math.max(0,r-n)*Math.max(0,s-i)}function x(e,t){return e.minX<=t.minX&&e.minY<=t.minY&&t.maxX<=e.maxX&&t.maxY<=e.maxY}function _(e,t){return t.minX<=e.maxX&&t.minY<=e.maxY&&t.maxX>=e.minX&&t.maxY>=e.minY}function v(e,t,n,i,r){const s=[t,n];for(;s.length;){const t=s.pop(),n=s.pop();if(t-n<=i)continue;const a=n+Math.ceil((t-n)/i/2)*i;(0,o.q)(e,a,n,t,r),s.push(n,a,a,t)}}const w=new s.A,P=new s.A,M=new s.A,I=new s.A({deallocator:void 0});class b{constructor(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0}}class A extends b{constructor(){super(...arguments),this.height=1,this.indexHint=new i.vW}}class C extends A{constructor(e){super(),this.children=e,this.leaf=!0}}class R extends A{constructor(e){super(),this.children=e,this.leaf=!1}}},80754:(e,t,n)=>{n.d(t,{j7:()=>o,kS:()=>l,kd:()=>a,r8:()=>c});var i=n(82799),r=n(16930),s=n(65864);const o={102100:{maxX:20037508.342788905,minX:-20037508.342788905,plus180Line:new i.A({paths:[[[20037508.342788905,-20037508.342788905],[20037508.342788905,20037508.342788905]]],spatialReference:r.A.WebMercator}),minus180Line:new i.A({paths:[[[-20037508.342788905,-20037508.342788905],[-20037508.342788905,20037508.342788905]]],spatialReference:r.A.WebMercator})},4326:{maxX:180,minX:-180,plus180Line:new i.A({paths:[[[180,-180],[180,180]]],spatialReference:r.A.WGS84}),minus180Line:new i.A({paths:[[[-180,-180],[-180,180]]],spatialReference:r.A.WGS84})}};function a(e,t){return Math.ceil((e-t)/(2*t))}function l(e,t){const n=c(e);for(const e of n)for(const n of e)n[0]+=t;return e}function c(e){return(0,s.Bi)(e)?e.rings:e.paths}},85648:(e,t,n)=>{n.d(t,{n:()=>r});var i=n(84952);function r(e){return s[function(e){return"json"===e.type?"application/json":"blob"===e.type?e.blob.type:function(e){const t=(0,i.Zo)(e);return l[t]||o}(e.url)}(e)]||a}const s={},o="text/plain",a=s[o],l={png:"image/png",jpeg:"image/jpeg",jpg:"image/jpg",bmp:"image/bmp",gif:"image/gif",json:"application/json",txt:"text/plain",xml:"application/xml",svg:"image/svg+xml",zip:"application/zip",pbf:"application/vnd.mapbox-vector-tile",gz:"application/gzip","bin.gz":"application/octet-stream"};for(const e in l)s[l[e]]=e},89056:(e,t,n)=>{n.d(t,{b3:()=>h,jZ:()=>u});var i=n(12195),r=n(19419),s=n(6606),o=n(95108),a=n(65864),l=n(80754),c=n(21325);function u(e){return d(e,!0)}function h(e){return d(e,!1)}function d(e,t){if(null==e)return null;const n=e.spatialReference,r=(0,c.Vp)(n),o=(0,i.W)(e)?e.toJSON():e;if(!r)return o;const u=(0,c.K8)(n)?102100:4326,h=l.j7[u].maxX,d=l.j7[u].minX;if((0,a.fT)(o))return m(o,h,d);if((0,a.U9)(o))return o.points=o.points.map(e=>m(e,h,d)),o;if((0,a.ZC)(o))return p(o,r);if((0,a.Bi)(o)||(0,a.Rg)(o)){const e=(0,s.Rg)(v,o),n={xmin:e[0],ymin:e[1],xmax:e[2],ymax:e[3]},i=(0,l.kd)(n.xmin,d)*(2*h),r=0===i?o:(0,l.kS)(o,i);return n.xmin+=i,n.xmax+=i,n.xmax>h?x(r,h,t):n.xmin<d?x(r,d,t):r}return o}function p(e,t){if(!t)return e;const n=function(e,t){const n=[],{ymin:i,ymax:r,xmin:s,xmax:o}=e,a=e.xmax-e.xmin,[l,c]=t.valid,{x:u,frameId:h}=f(e.xmin,t),{x:d,frameId:p}=f(e.xmax,t),m=u===d&&a>0;if(a>2*c){const e={xmin:s<o?u:d,ymin:i,xmax:c,ymax:r},t={xmin:l,ymin:i,xmax:s<o?d:u,ymax:r},a={xmin:0,ymin:i,xmax:c,ymax:r},m={xmin:l,ymin:i,xmax:0,ymax:r},f=[],y=[];g(e,a)&&f.push(h),g(e,m)&&y.push(h),g(t,a)&&f.push(p),g(t,m)&&y.push(p);for(let e=h+1;e<p;e++)f.push(e),y.push(e);n.push(new _(e,[h]),new _(t,[p]),new _(a,f),new _(m,y))}else u>d||m?n.push(new _({xmin:u,ymin:i,xmax:c,ymax:r},[h]),new _({xmin:l,ymin:i,xmax:d,ymax:r},[p])):n.push(new _({xmin:u,ymin:i,xmax:d,ymax:r},[h]));return n}(e,t).map(e=>e.extent);return n.length<2?n[0]||e:n.length>2?(e.xmin=t.valid[0],e.xmax=t.valid[1],e):{rings:n.map(e=>[[e.xmin,e.ymin],[e.xmin,e.ymax],[e.xmax,e.ymax],[e.xmax,e.ymin],[e.xmin,e.ymin]])}}function m(e,t,n){if(Array.isArray(e)){const i=e[0];if(i>t){const n=(0,l.kd)(i,t);e[0]=i+n*(-2*t)}else if(i<n){const t=(0,l.kd)(i,n);e[0]=i+t*(-2*n)}}else{const i=e.x;if(i>t){const n=(0,l.kd)(i,t);e.x+=n*(-2*t)}else if(i<n){const t=(0,l.kd)(i,n);e.x+=t*(-2*n)}}return e}function f(e,t){const[n,i]=t.valid,r=2*i;let s,o=0;return e>i?(s=Math.ceil(Math.abs(e-i)/r),e-=s*r,o=s):e<n&&(s=Math.ceil(Math.abs(e-n)/r),e+=s*r,o=-s),{x:e,frameId:o}}function g(e,t){const{xmin:n,ymin:i,xmax:r,ymax:s}=t;return y(e,n,i)&&y(e,n,s)&&y(e,r,s)&&y(e,r,i)}function y(e,t,n){return t>=e.xmin&&t<=e.xmax&&n>=e.ymin&&n<=e.ymax}function x(e,t,n=!0){const i=!(0,a.Rg)(e);if(i&&(0,o.m3)(e),n)return(new w).cut(e,t);const r=i?e.rings:e.paths,s=i?4:2,l=r.length,c=-2*t;for(let e=0;e<l;e++){const t=r[e];if(t&&t.length>=s){const e=[];for(const n of t)e.push([n[0]+c,n[1]]);r.push(e)}}return i?e.rings=r:e.paths=r,e}class _{constructor(e,t){this.extent=e,this.frameIds=t}}const v=(0,r.vt)();class w{constructor(){this._linesIn=[],this._linesOut=[]}cut(e,t){let n;if(this._xCut=t,e.rings)this._closed=!0,n=e.rings,this._minPts=4;else{if(!e.paths)return null;this._closed=!1,n=e.paths,this._minPts=2}for(const e of n){if(!e||e.length<this._minPts)continue;let t=!0;for(const n of e)t?(this.moveTo(n),t=!1):this.lineTo(n);this._closed&&this.close()}this._pushLineIn(),this._pushLineOut(),n=[];for(const e of this._linesIn)e&&e.length>=this._minPts&&n.push(e);const i=-2*this._xCut;for(const e of this._linesOut)if(e&&e.length>=this._minPts){for(const t of e)t[0]+=i;n.push(e)}return this._closed?e.rings=n:e.paths=n,e}moveTo(e){this._pushLineIn(),this._pushLineOut(),this._prevSide=this._side(e[0]),this._moveTo(e[0],e[1],this._prevSide),this._prevPt=e,this._firstPt=e}lineTo(e){const t=this._side(e[0]);if(t*this._prevSide===-1){const n=this._intersect(this._prevPt,e);this._lineTo(this._xCut,n,0),this._prevSide=0,this._lineTo(e[0],e[1],t)}else this._lineTo(e[0],e[1],t);this._prevSide=t,this._prevPt=e}close(){const e=this._firstPt,t=this._prevPt;e[0]===t[0]&&e[1]===t[1]||this.lineTo(e),this._checkClosingPt(this._lineIn),this._checkClosingPt(this._lineOut)}_moveTo(e,t,n){this._closed?(this._lineIn.push([n<=0?e:this._xCut,t]),this._lineOut.push([n>=0?e:this._xCut,t])):(n<=0&&this._lineIn.push([e,t]),n>=0&&this._lineOut.push([e,t]))}_lineTo(e,t,n){this._closed?(P(this._lineIn,n<=0?e:this._xCut,t),P(this._lineOut,n>=0?e:this._xCut,t)):n<0?(0===this._prevSide&&this._pushLineOut(),this._lineIn.push([e,t])):n>0?(0===this._prevSide&&this._pushLineIn(),this._lineOut.push([e,t])):this._prevSide<0?(this._lineIn.push([e,t]),this._lineOut.push([e,t])):this._prevSide>0&&(this._lineOut.push([e,t]),this._lineIn.push([e,t]))}_checkClosingPt(e){const t=e.length;t>3&&e[0][0]===this._xCut&&e[t-2][0]===this._xCut&&e[1][0]===this._xCut&&(e[0][1]=e[t-2][1],e.pop())}_side(e){return e<this._xCut?-1:e>this._xCut?1:0}_intersect(e,t){const n=(this._xCut-e[0])/(t[0]-e[0]);return e[1]+n*(t[1]-e[1])}_pushLineIn(){this._lineIn&&this._lineIn.length>=this._minPts&&this._linesIn.push(this._lineIn),this._lineIn=[]}_pushLineOut(){this._lineOut&&this._lineOut.length>=this._minPts&&this._linesOut.push(this._lineOut),this._lineOut=[]}}function P(e,t,n){const i=e.length;i>1&&e[i-1][0]===t&&e[i-2][0]===t?e[i-1][1]=n:e.push([t,n])}}}]);