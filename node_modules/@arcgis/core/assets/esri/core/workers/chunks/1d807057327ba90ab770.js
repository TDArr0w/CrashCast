"use strict";(self.webpackChunkRemoteClient=self.webpackChunkRemoteClient||[]).push([[3116,7548],{751:(e,t,r)=>{r.d(t,{CJ:()=>h});var n=r(49186),i=r(4718),s=r(93637),a=r(67124),o=r(77548);const l=new Set(["bing-maps","imagery","imagery-tile","map-image","open-street-map","tile","unknown","unsupported","vector-tile","web-tile","wcs","wms","wmts"]),u=new Set(["integrated-mesh-3dtiles"]),c=new Set(["catalog","csv","feature","geo-rss","geojson","group","imagery","imagery-tile","kml","knowledge-graph","map-image","map-notes","media","ogc-feature","oriented-imagery","route","stream","subtype-group","tile","unknown","unsupported","vector-tile","video","web-tile","wcs","wfs","wms","wmts"]),p=new Set([...c,"link-chart"]);function d(e,t){if(t.restrictedWebMapWriting){const r=function(e){switch(e.layerContainerType){case"basemap-base-layers":return l;case"basemap-ground-layers":return u;case"operational-layers":return"link-chart"===e.origin?p:c;default:return null}}(t);return null==r||r.has(e.type)&&!(0,o.Ov)(e)}return!0}function y(e,t){"maxScale"in e&&(t.maxScale=(0,a.B)(e.maxScale)??void 0),"minScale"in e&&(t.minScale=(0,a.B)(e.minScale)??void 0)}function h(e,t,r){if(!e.persistenceEnabled)return null;if(!("write"in e)||!e.write)return r?.messages&&r.messages.push(new n.A("layer:unsupported",`Layers (${e.title}, ${e.id}) of type '${e.declaredClass}' cannot be persisted`,{layer:e})),null;if((0,o.Ov)(e)&&!e.isTable)t=e.resourceInfo;else if(d(e,r)){const t={};return e.write(t,r)?t:null}return null!=t&&function(e,t){if(function(e,t){if(t)if((0,o.Ov)(e)){const r=(0,s.wc)("featureCollection.layers",t),n=r?.[0]?.layerDefinition;n&&y(e,n)}else"group"!==e.type&&y(e,t)}(e,t),t&&(t.id=e.id,"blendMode"in e&&(t.blendMode=e.blendMode,"normal"===t.blendMode&&delete t.blendMode),t.opacity=(0,a.B)(e.opacity)??void 0,t.title=e.title||"Layer",t.visibility=e.visible,"legendEnabled"in e&&"wmts"!==e.type))if((0,o.Ov)(e)){const r=t.featureCollection;r&&(r.showLegend=e.legendEnabled)}else t.showLegend=e.legendEnabled}(e,t=(0,i.o8)(t)),t}},4146:(e,t,r)=>{r.d(t,{A:()=>b});var n=r(31635),i=r(78888),s=r(49186),a=r(65529),o=r(4902),l=r(92474),u=r(53966),c=r(74887),p=r(84952),d=r(10107),y=(r(44208),r(87811),r(64108)),h=r(5443),g=r(16930),f=r(92602),m=r(79677);let w=0,b=class extends((0,a.Zt)((0,o.sA)(l.x_))){constructor(){super(...arguments),this.attributionDataUrl=null,this.fullExtent=new h.A(-180,-90,180,90,g.A.WGS84),this.id=Date.now().toString(16)+"-layer-"+w++,this.legendEnabled=!0,this.listMode="show",this.opacity=1,this.parent=null,this.persistenceEnabled=!1,this.popupEnabled=!0,this.attributionVisible=!0,this.spatialReference=g.A.WGS84,this.title=null,this.type=null,this.url=null,this.visibilityTimeExtent=null,this.visible=!0}static async fromArcGISServerUrl(e){const t="string"==typeof e?{url:e}:e;return(await Promise.all([r.e(812),r.e(7982)]).then(r.bind(r,27982))).fromUrl(t)}static fromPortalItem(e){return async function(e){const t="portalItem"in e?e:{portalItem:e},{fromItem:n}=await Promise.all([r.e(812),r.e(5613),r.e(5710)]).then(r.bind(r,45613));try{return await n(t)}catch(e){const r=t?.portalItem,n=r?.id||"unset",i=r?.portal?.url||f.A.portalUrl;throw u.A.getLogger("esri.layers.support.fromPortalItem").error("#fromPortalItem()","Failed to create layer from portal item (portal: '"+i+"', id: '"+n+"')",e),e}}(e)}initialize(){this.when().catch(e=>{(0,c.zf)(e)||u.A.getLogger(this).error("#load()",`Failed to load layer (title: '${this.title??"no title"}', id: '${this.id??"no id"}')`,{error:e})})}destroy(){const{parent:e}=this;e&&(this.parent=null,e.removeChildLayer?.(this))}get effectiveVisible(){return this.visible&&(this.parent?.effectiveVisible??!0)}get hasAttributionData(){return null!=this.attributionDataUrl}get loaded(){return super.loaded}removeFromParent(){const{parent:e}=this;e&&(e.removeChildLayer?.(this),this.parent=null)}get parsedUrl(){return(0,p.An)(this.url)}createLayerView(e,t){return Promise.reject(new s.A("layer:create-layer-view","Layer does not support creating a layer view"))}async fetchAttributionData(){const e=this.attributionDataUrl;if(this.hasAttributionData&&e)return(await(0,i.A)(e,{query:{f:"json"},responseType:"json"})).data;throw new s.A("layer:no-attribution-data","Layer does not have attribution data")}};(0,n.Cg)([(0,d.MZ)({type:String})],b.prototype,"attributionDataUrl",void 0),(0,n.Cg)([(0,d.MZ)({readOnly:!0})],b.prototype,"effectiveVisible",null),(0,n.Cg)([(0,d.MZ)({type:h.A})],b.prototype,"fullExtent",void 0),(0,n.Cg)([(0,d.MZ)({readOnly:!0})],b.prototype,"hasAttributionData",null),(0,n.Cg)([(0,d.MZ)({type:String,clonable:!1})],b.prototype,"id",void 0),(0,n.Cg)([(0,d.MZ)({type:Boolean,nonNullable:!0})],b.prototype,"legendEnabled",void 0),(0,n.Cg)([(0,d.MZ)({type:["show","hide","hide-children"]})],b.prototype,"listMode",void 0),(0,n.Cg)([(0,d.MZ)({type:Number,range:{min:0,max:1},nonNullable:!0})],b.prototype,"opacity",void 0),(0,n.Cg)([(0,d.MZ)({clonable:!1})],b.prototype,"parent",void 0),(0,n.Cg)([(0,d.MZ)({readOnly:!0})],b.prototype,"parsedUrl",null),(0,n.Cg)([(0,d.MZ)({type:Boolean,readOnly:!0})],b.prototype,"persistenceEnabled",void 0),(0,n.Cg)([(0,d.MZ)({type:Boolean})],b.prototype,"popupEnabled",void 0),(0,n.Cg)([(0,d.MZ)({type:Boolean})],b.prototype,"attributionVisible",void 0),(0,n.Cg)([(0,d.MZ)({type:g.A})],b.prototype,"spatialReference",void 0),(0,n.Cg)([(0,d.MZ)({type:String})],b.prototype,"title",void 0),(0,n.Cg)([(0,d.MZ)({readOnly:!0,json:{read:!1}})],b.prototype,"type",void 0),(0,n.Cg)([(0,d.MZ)()],b.prototype,"url",void 0),(0,n.Cg)([(0,d.MZ)({type:m.A})],b.prototype,"visibilityTimeExtent",void 0),(0,n.Cg)([(0,d.MZ)({type:Boolean,nonNullable:!0})],b.prototype,"visible",void 0),b=(0,n.Cg)([(0,y.$)("esri.layers.Layer")],b)},4902:(e,t,r)=>{r.d(t,{PH:()=>o,sA:()=>a});var n=r(31635),i=r(64108);let s=0;const a=e=>{const t=e;let r=class extends t{constructor(...e){super(...e),Object.defineProperty(this,"uid",{writable:!1,configurable:!1,value:Date.now().toString(16)+"-object-"+s++})}};return r=(0,n.Cg)([(0,i.$)("esri.core.Identifiable")],r),r},o=e=>{const t=e;let r=class extends t{constructor(...e){super(...e),Object.defineProperty(this,"uid",{writable:!1,configurable:!1,value:s++})}};return r=(0,n.Cg)([(0,i.$)("esri.core.Identifiable.NumericIdentifiable")],r),r};a(class{})},16215:(e,t,r)=>{r.d(t,{S:()=>i,Y:()=>n});const n=Symbol("BasemapInstance");function i(e){return null!=e&&"object"==typeof e&&n in e}},18047:(e,t,r)=>{r.d(t,{Up:()=>l,ZV:()=>u,yx:()=>o});var n=r(73444);const i={ar:"ar-u-nu-latn",bs:"sr-Latn-CS",nn:"no-NN"};let s=new WeakMap,a={};function o(e={}){const t={};return null!=e.digitSeparator&&(t.useGrouping=e.digitSeparator),null!=e.places&&(t.minimumFractionDigits=t.maximumFractionDigits=e.places),t}function l(e){const{minimumFractionDigits:t,maximumFractionDigits:r,useGrouping:n}=e;return{minimumFractionDigits:t,maximumFractionDigits:r,useGrouping:"auto"===n?"auto":"always"===n}}function u(e,t){return Object.is(e,-0)&&(e=0),function(e){const t=e||a;if(!s.has(t)){const r=(0,n.lR)(),a=r&&i[r]||(0,n.QC)();s.set(t,new Intl.NumberFormat(a,e))}return s.get(t)}(t).format(e)}(0,n.Ml)(()=>{s=new WeakMap,a={}}),new Map},36708:(e,t,r)=>{r.d(t,{C_:()=>d,OH:()=>g,Vh:()=>f,on:()=>p,pc:()=>m,wB:()=>l,z7:()=>u});var n=r(37955),i=r(36563),s=r(97768),a=r(74887),o=r(14012);function l(e,t,r={}){return c(e,t,r,y)}function u(e,t,r={}){return c(e,t,r,h)}function c(e,t,r={},n){let i=null;const a=r.once?(e,r)=>{n(e)&&((0,s.xt)(i),t(e,r))}:(e,r)=>{n(e)&&t(e,r)};if(i=(0,o.Cn)(e,a,r.sync,r.equals),r.initial){const t=e();a(t,t)}return i}function p(e,t,r,a={}){let o=null,u=null,c=null;function p(){o&&u&&(u.remove(),a.onListenerRemove?.(o),o=null,u=null)}function d(e){a.once&&a.once&&(0,s.xt)(c),r(e)}const y=l(e,(e,r)=>{p(),(0,n.wb)(e)&&(o=e,u=(0,n.on)(e,t,d),a.onListenerAdd?.(e))},{sync:a.sync,initial:!0});return c=(0,i.hA)(()=>{y.remove(),p()}),c}function d(e,t){return function(e,t,r){if((0,a.G4)(r))return Promise.reject((0,a.NK)());const n=e();if(t?.(n))return Promise.resolve(n);let o=null;function l(){o=(0,s.xt)(o)}return new Promise((n,s)=>{o=(0,i.vE)([(0,a.u7)(r,()=>{l(),s((0,a.NK)())}),c(e,e=>{l(),n(e)},{sync:!1,once:!0},t??y)])})}(e,h,t)}function y(e){return!0}function h(e){return!!e}r(80559);const g={sync:!0},f={initial:!0},m={sync:!0,initial:!0}},47566:(e,t,r)=>{r(97770),r(18047),r(71754),r(73444);var n=r(10838),i=r(78888),s=r(49186);async function a(e){if(null!=l.fetchBundleAsset)return l.fetchBundleAsset(e);const t=await(0,i.A)(e,{responseType:"text"});return JSON.parse(t.data)}class o{constructor({base:e="",pattern:t,location:r=new URL(window.location.href)}){let n;n="string"==typeof r?e=>new URL(e,new URL(r,window.location.href)).href:r instanceof URL?e=>new URL(e,r).href:r,this.pattern="string"==typeof t?new RegExp(`^${t}`):t,this.getAssetUrl=n,e=e?e.endsWith("/")?e:e+"/":"",this.matcher=new RegExp(`^${e}(?:(.*)\\/)?(.*)$`)}fetchMessageBundle(e,t){return async function(e,t,r,i){const o=t.exec(r);if(!o)throw new s.A("esri-intl:invalid-bundle",`Bundle id "${r}" is not compatible with the pattern "${t}"`);const l=o[1]?`${o[1]}/`:"",u=o[2],c=(0,n.xO)(i),p=`${l}${u}.json`,d=c?`${l}${u}_${c}.json`:p;let y;try{y=await a(e(d))}catch(t){if(d===p)throw new s.A("intl:unknown-bundle",`Bundle "${r}" cannot be loaded`,{error:t});try{y=await a(e(p))}catch(e){throw new s.A("intl:unknown-bundle",`Bundle "${r}" cannot be loaded`,{error:e})}}return y}(this.getAssetUrl,this.matcher,e,t)}}const l={};var u,c=r(2741);(0,n.ao)((u={pattern:"esri/",location:c.s},new o(u)))},60999:(e,t,r)=>{r.d(t,{DZ:()=>h,Ke:()=>y,Tj:()=>c,UT:()=>g,jJ:()=>u});var n=r(31635),i=r(65008),s=r(97768),a=r(74887),o=r(10107),l=r(64108);function u(e,t,r){return(0,a.Lx)(e.map((e,n)=>t.apply(r,[e,n])))}async function c(e,t,r){return(await(0,a.Lx)(e.map((e,n)=>t.apply(r,[e,n])))).map(e=>e.value)}function p(e){return{ok:!0,value:e}}function d(e){return{ok:!1,error:e}}async function y(e){if(null==e)return{ok:!1,error:new Error("no promise provided")};try{return p(await e)}catch(e){return d(e)}}async function h(e){try{return p(await e)}catch(e){return(0,a.QP)(e),d(e)}}function g(e,t){return new f(e,t)}let f=class extends i.A{get value(){return null!=(e=this._result)&&!0===e.ok?e.value:null;var e}get error(){return null!=(e=this._result)&&!1===e.ok?e.error:null;var e}get finished(){return null!=this._result}constructor(e,t){super({}),this._result=null,this._abortHandle=null,this.abort=()=>{this._abortController=(0,s.DC)(this._abortController)},this.remove=this.abort,this._abortController=new AbortController;const{signal:r}=this._abortController;this.promise=e(r),this.promise.then(e=>{this._result=p(e),this._cleanup()},e=>{this._result=d(e),this._cleanup()}),this._abortHandle=(0,a.u7)(t,this.abort)}normalizeCtorArgs(){return{}}destroy(){this.abort()}_cleanup(){this._abortHandle=(0,s.xt)(this._abortHandle),this._abortController=null}};(0,n.Cg)([(0,o.MZ)()],f.prototype,"value",null),(0,n.Cg)([(0,o.MZ)()],f.prototype,"error",null),(0,n.Cg)([(0,o.MZ)()],f.prototype,"finished",null),(0,n.Cg)([(0,o.MZ)()],f.prototype,"promise",void 0),(0,n.Cg)([(0,o.MZ)()],f.prototype,"_result",void 0),f=(0,n.Cg)([(0,l.$)("esri.core.asyncUtils.ReactiveTask")],f)},62885:(e,t,r)=>{r.d(t,{H:()=>s,V:()=>i});var n=r(7762);function i(e,t,r=n.A){return t||(t=new r),t===e||t.destroyed||(t.removeAll(),(i=e)&&(Array.isArray(i)||"items"in i&&Array.isArray(i.items))?t.addMany(e):e&&t.add(e)),t;var i}function s(e){return e}},71754:(e,t,r)=>{r.d(t,{V:()=>u});var n=r(53966),i=r(93637),s=r(799),a=r(97770),o=r(18047);const l=()=>n.A.getLogger("esri.intl.substitute");function u(e,t,r={}){const{format:n={}}=r;return(0,s.HC)(e,e=>function(e,t,r){let n,s;const a=e.indexOf(":");if(-1===a?n=e.trim():(n=e.slice(0,a).trim(),s=e.slice(a+1).trim()),!n)return"";const o=(0,i.wc)(n,t);if(null==o)return"";const l=(s?r?.[s]:null)??r?.[n];return l?c(o,l):s?p(o,s):d(o)}(e,t,n))}function c(e,t){switch(t.type){case"date":return(0,a.Yq)(e,t.intlOptions);case"number":return(0,o.ZV)(e,t.intlOptions);default:return l().warn("missing format descriptor for key {key}"),d(e)}}function p(e,t){switch(t.toLowerCase()){case"dateformat":return(0,a.Yq)(e);case"numberformat":return(0,o.ZV)(e);default:return l().warn(`inline format is unsupported since 4.12: ${t}`),/^(dateformat|datestring)/i.test(t)?(0,a.Yq)(e):/^numberformat/i.test(t)?(0,o.ZV)(e):d(e)}}function d(e){switch(typeof e){case"string":return e;case"number":return(0,o.ZV)(e);case"boolean":return""+e;default:return e instanceof Date?(0,a.Yq)(e):""}}},77548:(e,t,r)=>{r.d(t,{Gh:()=>m,tk:()=>y,BR:()=>d,wI:()=>p,G$:()=>g,$x:()=>h,Ov:()=>l,UC:()=>s,W_:()=>u,OP:()=>f,TU:()=>o,XX:()=>a,jy:()=>c});var n=r(70333),i=r(78888);function s(e){return null!=e&&"object"==typeof e&&"type"in e&&"knowledge-graph-sublayer"===e.type}r(7762),r(84952),r(36563),r(36708),r(4146),new WeakMap,r(16215);const a={Point:"SceneLayer","3DObject":"SceneLayer",IntegratedMesh:"IntegratedMeshLayer",PointCloud:"PointCloudLayer",Building:"BuildingSceneLayer"};function o(e){const t=e?.type;return"building-scene"===t||"integrated-mesh"===t||"point-cloud"===t||"scene"===t}function l(e){return"feature"===e?.type&&!e.url&&"memory"===e.source?.type}function u(e){const t=e?.type;return("feature"===t||"subtype-group"===t||"oriented-imagery"===t)&&"feature-layer"===e?.source?.type}function c(e){return function(e){return null!=e&&"object"==typeof e&&"type"in e&&"feature"===e.type}(e)&&function(e){return"feature"===e?.type&&"feature-layer"===e.source?.type}(e)}async function p(e,t){const r=n.id?.findServerInfo(e);if(null!=r?.currentVersion)return r.owningSystemUrl||null;const s=e.toLowerCase().indexOf("/rest/services");if(-1===s)return null;const a=`${e.slice(0,s)}/rest/info`,o=null!=t?t.signal:null,{data:l}=await(0,i.A)(a,{query:{f:"json"},responseType:"json",signal:o});return l?.owningSystemUrl||null}function d(e){return function(e){if(!("capabilities"in e))return!1;switch(e.type){case"catalog":case"catalog-footprint":case"csv":case"feature":case"geojson":case"imagery":case"knowledge-graph-sublayer":case"ogc-feature":case"oriented-imagery":case"scene":case"sublayer":case"subtype-group":case"subtype-sublayer":case"wfs":return!0;default:return!1}}(e)?"effectiveCapabilities"in e?e.effectiveCapabilities:e.capabilities:null}function y(e){return!!function(e){if(!("editingEnabled"in e))return!1;switch(e.type){case"csv":case"feature":case"geojson":case"oriented-imagery":case"scene":case"subtype-group":case"subtype-sublayer":case"knowledge-graph-sublayer":return!0;default:return!1}}(e)&&("effectiveEditingEnabled"in e?e.effectiveEditingEnabled:e.editingEnabled)}function h(e,t){return null}function g(e){return null}function f(e){return!e||"Feature Service"===e.type&&!e.sourceUrl}function m(e,t){if(!t||!f(e))return;const r=(e.url,null);r&&(e.url=r)}},79677:(e,t,r)=>{r.d(t,{A:()=>d});var n,i=r(31635),s=r(25482),a=r(88930),o=r(10107),l=(r(44208),r(53966),r(87811),r(36005)),u=r(64108),c=r(43937),p=r(98623);let d=class extends s.o{static{n=this}static get allTime(){return y}static get empty(){return h}static fromArray(e){return new n({start:null!=e[0]?new Date(e[0]):e[0],end:null!=e[1]?new Date(e[1]):e[1]})}constructor(e){super(e),this.end=null,this.start=null}readEnd(e,t){return null!=t.end?new Date(t.end):null}writeEnd(e,t){t.end=e?.getTime()??null}get isAllTime(){return this.equals(n.allTime)}get isEmpty(){return this.equals(n.empty)}readStart(e,t){return null!=t.start?new Date(t.start):null}writeStart(e,t){t.start=e?.getTime()??null}clone(){return new n({end:this.end,start:this.start})}equals(e){if(!e)return!1;const t=this.start?.getTime()??this.start,r=this.end?.getTime()??this.end,n=e.start?.getTime()??e.start,i=e.end?.getTime()??e.end;return t===n&&r===i}expandTo(e,t=p.qU){if(this.isEmpty||this.isAllTime)return this.clone();let r=this.start;r&&(r=(0,a.lL)(r,e,t));let i=this.end;if(i){const r=(0,a.lL)(i,e,t);i=i.getTime()===r.getTime()?r:(0,a.S1)(r,1,e,t)}return new n({start:r,end:i})}intersection(e){if(!e)return this.clone();if(this.isEmpty||e.isEmpty)return n.empty;if(this.isAllTime)return e.clone();if(e.isAllTime)return this.clone();const t=this.start?.getTime()??-1/0,r=this.end?.getTime()??1/0,i=e.start?.getTime()??-1/0,s=e.end?.getTime()??1/0;let a,o;return i>=t&&i<=r?a=i:t>=i&&t<=s&&(a=t),r>=i&&r<=s?o=r:s>=t&&s<=r&&(o=s),null==a||null==o||isNaN(a)||isNaN(o)?n.empty:new n({start:a===-1/0?null:new Date(a),end:o===1/0?null:new Date(o)})}offset(e,t,r=p.qU){if(this.isEmpty||this.isAllTime)return this.clone();const i=new n,{start:s,end:o}=this;return null!=s&&(i.start=(0,a.S1)(s,e,t,r)),null!=o&&(i.end=(0,a.S1)(o,e,t,r)),i}toArray(){return this.isEmpty?[void 0,void 0]:[this.start?.getTime()??null,this.end?.getTime()??null]}union(e){if(!e||e.isEmpty)return this.clone();if(this.isEmpty)return e.clone();if(this.isAllTime||e.isAllTime)return y.clone();const t=null!=this.start&&null!=e.start?new Date(Math.min(this.start.getTime(),e.start.getTime())):null,r=null!=this.end&&null!=e.end?new Date(Math.max(this.end.getTime(),e.end.getTime())):null;return new n({start:t,end:r})}};(0,i.Cg)([(0,o.MZ)({type:Date,json:{write:{allowNull:!0}}})],d.prototype,"end",void 0),(0,i.Cg)([(0,l.w)("end")],d.prototype,"readEnd",null),(0,i.Cg)([(0,c.K)("end")],d.prototype,"writeEnd",null),(0,i.Cg)([(0,o.MZ)({readOnly:!0,json:{read:!1}})],d.prototype,"isAllTime",null),(0,i.Cg)([(0,o.MZ)({readOnly:!0,json:{read:!1}})],d.prototype,"isEmpty",null),(0,i.Cg)([(0,o.MZ)({type:Date,json:{write:{allowNull:!0}}})],d.prototype,"start",void 0),(0,i.Cg)([(0,l.w)("start")],d.prototype,"readStart",null),(0,i.Cg)([(0,c.K)("start")],d.prototype,"writeStart",null),d=n=(0,i.Cg)([(0,u.$)("esri.time.TimeExtent")],d);const y=new d,h=new d({start:void 0,end:void 0})},81583:(e,t,r)=>{r.d(t,{L:()=>o,g:()=>a});var n=r(60999),i=r(7762),s=r(92474);async function a(e,t){return await e.load(),o(e,t)}async function o(e,t){const r=[],a=(...e)=>{for(const t of e)null!=t&&(Array.isArray(t)?a(...t):i.A.isCollection(t)?t.forEach(e=>a(e)):(0,s.Zm)(t)&&r.push(t))};t(a);let o=null;if(await(0,n.Tj)(r,async e=>{const t=await(0,n.Ke)(function(e){return"loadAll"in e&&"function"==typeof e.loadAll}(e)?e.loadAll():e.load());!1!==t.ok||o||(o=t)}),o)throw o.error;return e}},83116:(e,t,r)=>{r.r(t),r.d(t,{default:()=>O});var n=r(31635),i=r(92602),s=r(78888),a=r(7762),o=r(62885),l=r(25482),u=r(4718),c=r(92474),p=r(81583),d=r(53966),y=r(97768),h=r(74887),g=r(84952),f=r(10107),m=(r(44208),r(64108)),w=r(43937),b=r(16930),v=r(20655),L=r(80812),C=r(43281),A=(r(47566),r(65008)),M=(r(87811),r(73444)),S=r(10838);let I=class extends A.A{constructor(e){super(e),this.apiKey=null,this.id=null,this.language=null,this.places=null,this.serviceUrl="https://basemapstyles-api.arcgis.com/arcgis/rest/services/styles/v2",this.worldview=null}get languageParameter(){const e=this.language;let t="local"===e||"global"===e?e:(0,S.xO)(e??(0,M.JK)())??"global";return t="no"===t?"nb":t,t}};(0,n.Cg)([(0,f.MZ)()],I.prototype,"apiKey",void 0),(0,n.Cg)([(0,f.MZ)()],I.prototype,"id",void 0),(0,n.Cg)([(0,f.MZ)()],I.prototype,"language",void 0),(0,n.Cg)([(0,f.MZ)()],I.prototype,"places",void 0),(0,n.Cg)([(0,f.MZ)()],I.prototype,"serviceUrl",void 0),(0,n.Cg)([(0,f.MZ)()],I.prototype,"worldview",void 0),I=(0,n.Cg)([(0,m.$)("esri.support.BasemapStyle")],I);const T=I;var x,Z,_=r(16215),$=r(751);let E=class extends((0,l.T)(c.x_)){static{x=_.Y}static{Z=this}constructor(e){super(e),this[x]=!0,this.id=null,this.portalItem=null,this.spatialReference=null,this.style=null,this.thumbnailUrl=null,this.title="Basemap",this.type="Basemap",this.id=Date.now().toString(16)+"-basemap-"+Z.idCounter++,this.baseLayers=new a.A,this.referenceLayers=new a.A,this.groundLayers=new a.A;const t=e=>{const{parent:t}=e;t&&t!==this&&"remove"in t&&t.remove?.(e),e.parent=this,"elevation"!==e.type&&"integrated-mesh-3dtiles"!==e.type||d.A.getLogger(this).error(`Layer '${e.title}, id:${e.id}' of type '${e.type}' is not supported as a basemap layer and will therefore be ignored.`)},r=e=>{const{parent:t}=e;t&&t!==this&&"remove"in t&&t.remove?.(e),e.parent=this},n=e=>{e.parent=null},i=e=>{e.parent===this&&(e.parent=null)};this.addHandles([this.baseLayers.on("after-add",e=>t(e.item)),this.baseLayers.on("after-remove",e=>n(e.item)),this.referenceLayers.on("after-add",e=>t(e.item)),this.referenceLayers.on("after-remove",e=>n(e.item)),this.groundLayers.on("before-add",e=>{const t=e.item;return t.parent===this?(d.A.getLogger(this).error(`Layer '${t.title}, id:${t.id}' of type '${t.type}' already a ground layer, second add will be ignored.`),void e.preventDefault()):"integrated-mesh-3dtiles"!==t.type&&"integrated-mesh"!==t.type?(d.A.getLogger(this).error(`Layer '${t.title}, id:${t.id}' of type '${t.type}' is not supported as a ground layer and will therefore be ignored.`),void e.preventDefault()):void 0}),this.groundLayers.on("after-add",e=>r(e.item)),this.groundLayers.on("after-remove",e=>i(e.item))])}static{this.idCounter=0}initialize(){this.when().catch(e=>{d.A.getLogger(this).error("#load()",`Failed to load basemap (title: '${this.title}', id: '${this.id}')`,e)}),this.resourceInfo&&this.read(this.resourceInfo.data,this.resourceInfo.context)}destroy(){const e=this.baseLayers.toArray();for(const t of e)t.destroyed||t.destroy();const t=this.groundLayers.toArray();for(const e of t)e.destroyed||e.destroy();const r=this.referenceLayers.toArray();for(const e of r)e.destroyed||e.destroy();this.baseLayers.destroy(),this.groundLayers.destroy(),this.referenceLayers.destroy(),this.portalItem=(0,y.pR)(this.portalItem)}removeChildLayer(e){for(const t of[this.baseLayers,this.referenceLayers,this.groundLayers])t.remove(e)}normalizeCtorArgs(e){return e&&"resourceInfo"in e&&(this._set("resourceInfo",e.resourceInfo),delete(e={...e}).resourceInfo),e}set baseLayers(e){this._set("baseLayers",(0,o.V)(e,this._get("baseLayers")))}_writeBaseLayers(e,t,r){const n=[];e?(r={...r,layerContainerType:"basemap-base-layers"},this.baseLayers.forEach(e=>{const t=(0,$.CJ)(e,r.webmap?r.webmap.getLayerJSONFromResourceInfo(e):null,r);null!=t&&n.push(t)}),this.referenceLayers.forEach(e=>{const t=(0,$.CJ)(e,r.webmap?r.webmap.getLayerJSONFromResourceInfo(e):null,r);null!=t&&("scene"!==e.type&&(t.isReference=!0),n.push(t))}),t.baseMapLayers=n):t.baseMapLayers=n}set groundLayers(e){this._set("groundLayers",(0,o.V)(e,this._get("groundLayers")))}_writeGroundLayers(e,t,r){const n=[];e&&(r={...r,layerContainerType:"basemap-ground-layers"},this.groundLayers.forEach(e=>{const t=(0,$.CJ)(e,r.webmap?r.webmap.getLayerJSONFromResourceInfo(e):null,r);null!=t&&n.push(t)}),n.length>0&&(t.groundLayers=n))}get loaded(){return super.loaded}set referenceLayers(e){this._set("referenceLayers",(0,o.V)(e,this._get("referenceLayers")))}writeTitle(e,t){t.title=e||"Basemap"}load(e){return this.addResolvingPromise(this._loadFromSource(e)),Promise.resolve(this)}loadAll(){return(0,p.g)(this,e=>{e(this.baseLayers,this.groundLayers,this.referenceLayers)})}clone(){const e={id:this.id,title:this.title,portalItem:this.portalItem,baseLayers:this.baseLayers.map(e=>(0,u.Nb)(e)?e.clone():e),groundLayers:this.groundLayers.map(e=>(0,u.Nb)(e)?e.clone():e),referenceLayers:this.referenceLayers.map(e=>(0,u.Nb)(e)?e.clone():e)};return this.loaded&&(e.loadStatus="loaded"),new Z({resourceInfo:this.resourceInfo}).set(e)}read(e,t){this.resourceInfo||this._set("resourceInfo",{data:e,context:t}),super.read(e,t)}write(e,t){return e=e||{},t?.origin||(t={origin:"web-map",...t}),super.write(e,t),!this.loaded&&this.resourceInfo?.data.baseMapLayers&&(e.baseMapLayers=this.resourceInfo.data.baseMapLayers.map(e=>{const t=(0,u.o8)(e);return t.url&&(0,g.BQ)(t.url)&&(t.url=`https:${t.url}`),t.templateUrl&&(0,g.BQ)(t.templateUrl)&&(t.templateUrl=`https:${t.templateUrl}`),t})),e}async _loadFromSource(e){const{resourceInfo:t,portalItem:r,style:n}=this;(0,h.Te)(e);const i=[];if(t){const r=t.context?t.context.url:null;if(i.push(this._loadLayersFromJSON(t.data,r,e)),t.data.id&&!t.data.title){const e=t.data.id;i.push((0,C.q)(e).then(e=>{e&&this.read({title:e},t.context)}))}}else r?i.push(this._loadFromItem(r,e)):n&&i.push(this._loadFromStylesService(n,e));await Promise.all(i)}async _loadLayersFromJSON(e,t,n){const i=this.resourceInfo?.context,s=this.portalItem?.portal||i?.portal||null,a=D[i?.origin||""]??"web-map",{populateOperationalLayers:o}=await Promise.all([r.e(5613),r.e(9933)]).then(r.bind(r,75356)),l=[];if((0,h.Te)(n),e.baseMapLayers&&Array.isArray(e.baseMapLayers)){const r={context:{...i,origin:a,url:t,portal:s,layerContainerType:"basemap-base-layers"},defaultLayerType:"DefaultTileLayer"},n=e=>"web-scene"===a&&"ArcGISSceneServiceLayer"===e.layerType||e.isReference,u=o(this.baseLayers,e.baseMapLayers.filter(e=>!n(e)),r);l.push(u);const c=o(this.referenceLayers,e.baseMapLayers.filter(n),r);l.push(c)}if(e.groundLayers&&Array.isArray(e.groundLayers)){const r={context:{...i,origin:a,url:t,portal:s,layerContainerType:"basemap-ground-layers"},defaultLayerType:"IntegratedMesh3DTilesLayer"},n=o(this.groundLayers,e.groundLayers,r);l.push(n)}await Promise.allSettled(l)}async _loadFromItem(e,t){const r=await e.load(t),n=await r.fetchData("json",t),i=(0,g.An)(e.itemUrl??"");return this._set("resourceInfo",{data:n.baseMap??{},context:{origin:U[e.type||""]??"web-map",portal:e.portal||v.A.getDefault(),url:i}}),this.read(this.resourceInfo.data,this.resourceInfo.context),this.read({spatialReference:n.spatialReference},this.resourceInfo.context),this.read({title:e.title,thumbnailUrl:e.thumbnailUrl},{origin:"portal-item",portal:e.portal||v.A.getDefault(),url:i}),this._loadLayersFromJSON(this.resourceInfo.data,i,t)}async _loadFromStylesService(e,t){const r=e.serviceUrl.endsWith("/webmaps")?e.serviceUrl.slice(0,-8):e.serviceUrl,n=`${r}/styles/${e.id}/self`,a=`${r}/webmaps/${e.id}`,o=e.apiKey??i.A.apiKeys.basemapStyles,[l,u]=await Promise.all([(await(0,s.A)(n,{query:{token:o},signal:t?.signal})).data,(await(0,s.A)(a,{query:{language:e.languageParameter,places:e.places,worldview:e.worldview,token:o},signal:t?.signal})).data]);this.thumbnailUrl??=l.thumbnailUrl;const c=(0,g.An)(a);if(this._set("resourceInfo",{data:u.baseMap??{},context:{origin:"web-map",url:c}}),this.read(this.resourceInfo.data,this.resourceInfo.context),this.read({spatialReference:u.spatialReference},this.resourceInfo.context),await this._loadLayersFromJSON(this.resourceInfo.data,c,t),o)for(const e of[...this.baseLayers,...this.groundLayers,...this.referenceLayers])"apiKey"in e&&(e.apiKey=o)}static fromId(e){const t=C.H[e];return t?t.itemId?new Z({portalItem:{id:t.itemId,portal:{url:"https://www.arcgis.com"}}}):Z.fromJSON(t,t.is3d?{origin:"web-scene",portal:new v.A({url:"https://www.arcgis.com"})}:{origin:"web-map"}):null}};(0,n.Cg)([(0,f.MZ)({json:{read:!1,write:{ignoreOrigin:!0,target:"baseMapLayers",writer(e,t,r,n){this._writeBaseLayers(e,t,n)}},origins:{"web-scene":{write:{ignoreOrigin:!0,target:{baseMapLayers:{type:a.A}},writer(e,t,r,n){this._writeBaseLayers(e,t,n)}}}}}})],E.prototype,"baseLayers",null),(0,n.Cg)([(0,f.MZ)({json:{read:!1,write:{ignoreOrigin:!0,target:"groundLayers",writer(e,t,r,n){this._writeGroundLayers(e,t,n)}},origins:{"web-scene":{write:{ignoreOrigin:!0,target:{groundLayers:{type:a.A}},writer(e,t,r,n){this._writeGroundLayers(e,t,n)}}}}}})],E.prototype,"groundLayers",null),(0,n.Cg)([(0,f.MZ)({type:String,json:{origins:{"web-scene":{write:!0}}}})],E.prototype,"id",void 0),(0,n.Cg)([(0,f.MZ)({type:L.default})],E.prototype,"portalItem",void 0),(0,n.Cg)([(0,f.MZ)()],E.prototype,"referenceLayers",null),(0,n.Cg)([(0,f.MZ)({readOnly:!0})],E.prototype,"resourceInfo",void 0),(0,n.Cg)([(0,f.MZ)({type:b.A})],E.prototype,"spatialReference",void 0),(0,n.Cg)([(0,f.MZ)({type:T})],E.prototype,"style",void 0),(0,n.Cg)([(0,f.MZ)()],E.prototype,"thumbnailUrl",void 0),(0,n.Cg)([(0,f.MZ)({type:String,json:{origins:{"web-scene":{write:{isRequired:!0}}}}})],E.prototype,"title",void 0),(0,n.Cg)([(0,w.K)("title")],E.prototype,"writeTitle",null),E=Z=(0,n.Cg)([(0,m.$)("esri.Basemap")],E);const U={"Web Scene":"web-scene","Web Map":"web-map","Link Chart":"link-chart"},D={"web-scene":"web-scene","web-map":"web-map","link-chart":"link-chart"},O=E}}]);