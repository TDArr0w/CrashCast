/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.34/esri/copyright.txt for details.
*/
import{__decorate as e}from"tslib";import{property as o}from"../../core/accessorSupport/decorators/property.js";import"../../core/has.js";import"../../core/Logger.js";import"../../core/RandomLCG.js";import{reader as r}from"../../core/accessorSupport/decorators/reader.js";import{subclass as t}from"../../core/accessorSupport/decorators/subclass.js";import l from"../../geometry/SpatialReference.js";import i from"../support/TileInfo.js";import a from"../support/TileInfoTilemapCache.js";import{TilemapCache as s}from"../support/TilemapCache.js";const p=p=>{const n=p;let c=class extends n{constructor(){super(...arguments),this.copyright=null,this.minScale=0,this.maxScale=0,this.spatialReference=null,this.tileInfo=null,this.tilemapCache=null}destroy(){this.tilemapCache?.destroy?.()}readMinScale(e,o){return null!=o.minLOD&&null!=o.maxLOD?e:0}readMaxScale(e,o){return null!=o.minLOD&&null!=o.maxLOD?e:0}get supportsBlankTile(){return this.version>=10.2}readTilemapCache(e,o,r){const t=o.capabilities?.includes("Tilemap");let{minLOD:l,maxLOD:p,minScale:n,maxScale:c}=o;if(null==l&&null==p&&(0!==n||0!==c)){const e=e=>Math.round(1e4*e)/1e4;n=e(n||o.tileInfo.lods[0].scale),c=e(c||o.tileInfo.lods[o.tileInfo.lods.length-1].scale);for(const r of o.tileInfo.lods){const o=e(r.scale);l=o>=n?r.level:l,p=o>=c?r.level:p}}if(t)return new s({layer:this,minLOD:l,maxLOD:p});if(o.tileInfo){const e=new i;return e.read(o.tileInfo,r),new a(e,l,p)}return null}};return e([o({json:{read:{source:"copyrightText"}}})],c.prototype,"copyright",void 0),e([o()],c.prototype,"minScale",void 0),e([r("service","minScale")],c.prototype,"readMinScale",null),e([o()],c.prototype,"maxScale",void 0),e([r("service","maxScale")],c.prototype,"readMaxScale",null),e([o({type:l})],c.prototype,"spatialReference",void 0),e([o({readOnly:!0})],c.prototype,"supportsBlankTile",null),e([o({type:i})],c.prototype,"tileInfo",void 0),e([o()],c.prototype,"tilemapCache",void 0),e([r("service","tilemapCache",["capabilities","tileInfo"])],c.prototype,"readTilemapCache",null),e([o()],c.prototype,"version",void 0),c=e([t("esri.layers.mixins.ArcGISCachedService")],c),c};export{p as ArcGISCachedService};
