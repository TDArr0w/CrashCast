/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.34/esri/copyright.txt for details.
*/
import{d as e,e as n,g as r,k as t,E as o}from"../../../../chunks/vec32.js";import{create as i}from"../../../../core/libs/gl-matrix-2/factories/vec3f64.js";import{wrap as s}from"../../../../geometry/support/ray.js";import{i as c,j as a}from"../../../../chunks/sphere.js";import{defaultConstraintOptions as f,interactionDirectionTowardsConstraintMinimization as m,adjustRangeForInteraction as u}from"./common.js";function p(e,n,r=f){if(!e.state.isLocal)return 0;const t=e.state.constraints.distance;if(!e.pointsOfInterest.surfaceOrigin.renderLocation||t===1/0)return 0;x.min=0,x.max=t,y(e,r,x);const o=l(e,n),i=x.max-o;return i>=-1e-6?0:i}function d(t,o,i=f){const u=p(t,o,i);if(0===u)return!1;const d=t.pointsOfInterest.surfaceOrigin;if(!d.renderLocation)return!1;const y=l(t,o)+u,x=e(L,o.eye),k=m(o,i.interactionDirection,g(o,d.renderLocation,I),O);if(!c(a(d.renderLocation,y),s(o.eye,k),h))return!1;o.eye=h;const C=n(j,o.eye,x);o.center=r(h,o.center,C);const v=t.renderCoordsHelper.getAltitude(o.center),H=t.renderCoordsHelper.intersectInfiniteManifold(o.ray,v,h);return null!=H&&(o.center=H),!0}function y(e,n,r){const t=n.interactionType;if(0===t)return;const{min:o,max:i}=r,{interactionStartCamera:s,interactionFactor:c}=n;if(!s)return;const a=1===t||4===t,f=p(e,s),m=0===f?0:l(e,s);r.min=o,r.max=i;u(f,m,a,c,.05*m,r)}function l(e,n){const r=e.pointsOfInterest.surfaceOrigin;return r.renderLocation?t(n.eye,r.renderLocation):0}function g(e,n,r){return o(r,e.eye,n)}const x={min:0,max:0},L=i(),j=i(),O=i(),I=i(),h=i();export{d as applyDistanceConstraint,p as getDistanceConstraintError};
