/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.34/esri/copyright.txt for details.
*/
import{freeze as e,create as r,ZEROS as t}from"../../../../core/libs/gl-matrix-2/factories/vec3f64.js";import{newLayout as i}from"../../support/buffer/InterleavedLayout.js";import{isColorOrColorEmission as o}from"../core/shaderLibrary/ShaderOutput.js";import{PathVertexPositionPassParameters as s}from"../core/shaderLibrary/attributes/PathVertexPosition.glsl.js";import{ReloadableShaderModule as l}from"../core/shaderTechnique/ReloadableShaderModule.js";import{ShaderTechnique as a,depthOnlyOutputBuffersOr as n}from"../core/shaderTechnique/ShaderTechnique.js";import{olidEnabled as c}from"../effects/geometry/olidUtils.js";import{OITPolygonOffset as u,oitDepthTest as f,blending as m,getDrawBuffers as p}from"../lib/OrderIndependentTransparency.js";import{stencilBaseAllZerosParams as d,stencilWriteMaskOn as h}from"../lib/StencilUtils.js";import{advancedMRRFactors as b}from"./pbrUtils.js";import{P as g}from"../../../../chunks/Path.glsl.js";import{makePipelineState as j,defaultColorWrite as v,defaultDepthWrite as S,frontFaceCullingParams as y}from"../../../webgl/renderState.js";class P extends s{constructor(){super(...arguments),this.ambient=e(.2,.2,.2),this.diffuse=e(.8,.8,.8),this.opacity=1,this.origin=r(),this.modelTransformation=null,this.mrrFactors=b,this.emissiveStrength=0,this.emissiveSource=1,this.emissiveBaseColor=t}}class V extends a{constructor(e,r){super(e,r,new l(g,()=>import("../shaders/Path.glsl.js")),x(r).locations)}initializePipeline(e){const{output:r,transparent:t,hasSlicePlane:i,doubleSidedMode:s,hasOccludees:l,oitPass:a}=e,c=0===a,b=2===a;return j({blending:o(r)&&t?m(a):null,culling:i&&!t&&0!==s?y:null,depthTest:{func:f(a)},depthWrite:c||b?S:null,drawBuffers:n(r,p(a,r)),colorWrite:v,stencilWrite:l?h:null,stencilTest:l?d:null,polygonOffset:c||b?null:u})}}function x(e){const r=i().vec3f("position").vec4f16("profileVertexAndNormal").vec2i16("profileRight",{glNormalized:!0}).vec2i16("profileUp",{glNormalized:!0});return e.hasVVSize&&r.f32("sizeFeatureAttribute"),e.hasVVColor&&r.f32("colorFeatureAttribute"),e.hasVVOpacity&&r.f32("opacityFeatureAttribute"),c()&&r.vec4u8("olidColor"),r.vec3f16("profileAuxData"),r.freeze()}export{P as PathPassParameters,V as PathTechnique,x as getLayout};
