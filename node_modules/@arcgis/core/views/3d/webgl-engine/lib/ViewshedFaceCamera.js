/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.34/esri/copyright.txt for details.
*/
import{__decorate as t}from"tslib";import{rad2deg as o,deg2rad as e}from"../../../../core/mathUtils.js";import{property as s}from"../../../../core/accessorSupport/decorators/property.js";import"../../../../core/has.js";import"../../../../core/Logger.js";import"../../../../core/RandomLCG.js";import{subclass as r}from"../../../../core/accessorSupport/decorators/subclass.js";import{mul as i,fromTranslation as n,fromScaling as a}from"../../../../core/libs/gl-matrix-2/math/mat4.js";import{create as c}from"../../../../core/libs/gl-matrix-2/factories/mat4f64.js";import{create as l,fromArray as p}from"../../../../core/libs/gl-matrix-2/factories/vec4f64.js";import m from"../../webgl/RenderCamera.js";import{assert as h}from"./Util.js";let g=class extends m{constructor(){super(...arguments),this.sectionAngles=l()}get sectionAnglesDeg(){return p(this.sectionAngles.map(t=>o(t)))}set sectionAnglesDeg(t){this.sectionAngles=p(t.map(t=>e(t)))}get projectionMatrix(){return i(c(),this.sectionMatrix,this._projectionMatrixInternal)}get sectionMatrix(){const t=this.sectionAngles[0],o=this.sectionAngles[1],e=this.sectionAngles[2],s=this.sectionAngles[3];h(t<=o),h(e<=s);const r=2*Math.tan(this.fovX/2),l=2*Math.tan(this.fovY/2),p=Math.tan(t),m=Math.tan(o),g=Math.tan(e),f=m-p,M=Math.tan(s)-g,j=r/f,u=l/M,A=-(p+f/2)/r*2,x=-(g+M/2)/l*2,b=c();n(b,[A,x,0]);const d=c();a(d,[j,u,1]);const v=c();return i(v,d,b)}get _sectionRatioX(){const t=Math.tan(this.sectionAngles[0]),o=Math.tan(this.sectionAngles[1]),e=2*Math.tan(this.fovX/2);return Math.min(1,(o-t)/e)}setViewport(t,o){const e=o*this._sectionRatioX;return this.viewport=[t[0],t[1],e,o],e}};t([s()],g.prototype,"sectionAngles",void 0),t([s()],g.prototype,"sectionAnglesDeg",null),t([s()],g.prototype,"projectionMatrix",null),t([s()],g.prototype,"sectionMatrix",null),t([s()],g.prototype,"_sectionRatioX",null),g=t([r("esri.views.3d.webgl-engine.lib.ViewshedFaceCamera")],g);export{g as ViewshedFaceCamera};
