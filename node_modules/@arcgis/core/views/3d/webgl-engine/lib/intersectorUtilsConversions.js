/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.34/esri/copyright.txt for details.
*/
import{getScale as r}from"../../../../core/libs/gl-matrix-2/math/mat4.js";import{create as e}from"../../../../core/libs/gl-matrix-2/factories/vec3f64.js";import{diameter as t}from"../../../../geometry/support/aaBoundingBox.js";import{g as n}from"../../../../chunks/sphere.js";import{isPclIntersectorResult as i,isVoxelIntersectorResult as l,isI3sIntersectorResult as a}from"../../layers/i3s/Intersector.js";import{isOverlayIntersectorResult as o,isTerrainIntersectorResult as u}from"../../terrain/Intersector.js";import{isHUDIntersectorResult as c}from"./HUDIntersectorResult.js";import{isObjectIntersectorResult as s}from"./ObjectIntersectorResult.js";import{isLodIntersectorResult as g}from"./lodRendering/Intersector.js";function p(r,e){return s(r)||c(r)?j(r.target?.object,e):u(r)?e.map?.ground:r.target&&"layerViewUid"in r.target?j(r.target,e):null}function f(r,e){const t=d(r,e);return"graphic"===t?.type?t.graphic:null}function d(r,e,t={}){if(null==r)return null;if(s(r)||c(r))return m(r.target?.object,e,t);if(i(r)){const e=r.target.createGraphic();return{type:"graphic",graphic:e,layer:e.layer}}if(l(r)){const e=r.target.createVoxelGraphic();return{type:"graphic",graphic:e,layer:e.layer}}return o(r)||g(r)?m(r.target,e,t):a(r)?h(r.target,e,t):null}function m(r,e,t){if(null==r?.graphicUid)return null;const n=j(r,e);if(null==n)return null;if(n===e.graphics)return null==e.graphicsView||"number"!=typeof r.graphicUid?null:e.graphicsView.getHit(r.graphicUid,t);const i=e.allLayerViews.find(r=>r.layer===n);return!i||i.suspended||null==r.graphicUid?null:"getHit"in i?i.getHit(r.graphicUid,t):null}function h(r,e,t){const n=j(r,e);if(null==n)return null;const i=e.allLayerViews.find(r=>r.layer===n);if(!i||i.suspended||!("getGraphicFromIntersectorTarget"in i))return null;const l=t.defer;return V(i.getGraphicFromIntersectorTarget(r,{defer:l?r=>l(async()=>V(await r())):void 0}))}function y(r,e){const t=j(r,e);if(null==t)return null;const n=e.allLayerViews.find(r=>r.layer===t);return n&&!n.suspended&&"getAABBFromIntersectorTarget"in n?n.getAABBFromIntersectorTarget(r):null}function V(r){return null!=r?{type:"graphic",graphic:r,layer:r.layer}:null}function j(r,e){return null==r?.layerViewUid?null:null!=e.graphicsView&&r.layerViewUid===e.graphicsView.uid?e.graphics:e.allLayerViews.find(e=>e.uid===r.layerViewUid)?.layer}function w(e,i){if(s(e)||c(e))return n(e.target.object.boundingVolumeWorldSpace.bounds);if(g(e)){r(U,e.transformation);const t=Math.max(U[0],U[1],U[2]);return e.target.baseBoundingSphere.radius*t}if(a(e)){const r=y(e.target,i);return r?.5*t(r):null}return null}function b(r){return!s(r)&&!c(r)&&(g(r)?r.target.numLodLevels>1:!!a(r))}const U=e();export{w as getIntersectedFeatureBSRadius,b as hasLod,f as toGraphic,d as toHit,p as toOwner};
