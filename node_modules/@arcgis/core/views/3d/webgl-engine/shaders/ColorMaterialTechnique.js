/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.34/esri/copyright.txt for details.
*/
import{ZEROS as e}from"../../../../core/libs/gl-matrix-2/factories/vec4f64.js";import{newLayout as r}from"../../support/buffer/InterleavedLayout.js";import{isColorOrColorEmission as t}from"../core/shaderLibrary/ShaderOutput.js";import{ReloadableShaderModule as o}from"../core/shaderTechnique/ReloadableShaderModule.js";import{ShaderTechnique as i,depthOnlyOutputBuffersOr as s}from"../core/shaderTechnique/ShaderTechnique.js";import{olidEnabled as l}from"../effects/geometry/olidUtils.js";import{oitPolygonOffset as n,depthWrite as a,oitDepthTest as c,blending as u,getDrawBuffers as p}from"../lib/OrderIndependentTransparency.js";import{stencilToolMaskBaseParams as f,stencilBaseAllZerosParams as m,stencilWriteMaskOn as d}from"../lib/StencilUtils.js";import{VisualVariablePassParameters as h}from"../materials/VisualVariablePassParameters.js";import{C as j}from"../../../../chunks/ColorMaterial.glsl.js";import{makePipelineState as g,defaultColorWrite as P,cullingParams as b}from"../../../webgl/renderState.js";class S extends h{constructor(){super(...arguments),this.color=e}}class y extends i{constructor(e,r){super(e,r,new o(j,()=>import("./ColorMaterial.glsl.js")),v(r).locations)}_createPipeline(e,r){const{oitPass:o,output:i,transparent:l,cullFace:h,draped:j,hasOccludees:S,polygonOffset:y}=e,v=0===o;return g({blending:t(i)&&l?u(o):null,culling:b(h),depthTest:j?null:{func:c(o)},depthWrite:a(e),drawBuffers:s(i,p(o,i)),colorWrite:P,stencilWrite:S?d:null,stencilTest:S?r?f:m:null,polygonOffset:v?y?T:null:n(e)})}initializePipeline(e){return this._occludeePipelineState=this._createPipeline(e,!0),this._createPipeline(e,!1)}getPipeline(e){return e?this._occludeePipelineState:super.getPipeline()}}const T={factor:1,units:1};function v(e){const t=r().vec3f("position");return l()&&t.vec4u8("olidColor"),e.hasVVColor?t.f32("colorFeatureAttribute"):t.vec4u8("color"),t.freeze()}export{S as ColorMaterialPassParameters,y as ColorMaterialTechnique,v as getLayout};
