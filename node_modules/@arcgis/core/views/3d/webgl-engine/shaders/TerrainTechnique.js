/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.34/esri/copyright.txt for details.
*/
import{layout as e}from"../../terrain/TerrainAttributes.js";import{ReloadableShaderModule as i}from"../core/shaderTechnique/ReloadableShaderModule.js";import{ShaderTechnique as t,depthOnlyOutputBuffersOr as r}from"../core/shaderTechnique/ShaderTechnique.js";import{renderWhenBitIsNotSet as n}from"../lib/StencilUtils.js";import{a as l}from"../../../../chunks/Terrain.glsl.js";import{makePipelineState as s,defaultColorWrite as c,defaultDepthWrite as u,backFaceCullingParams as a,premultipliedAlpha as o}from"../../../webgl/renderState.js";class p extends t{constructor(t,r){super(t,r,new i(l,()=>import("./Terrain.glsl.js")),e.locations),this.type="TerrainTechnique",this.useStencil=!1}initializePipeline(e){return this._stencilPipelineState=this._createPipeline(e,!0),this._createPipeline(e,!1)}_createPipeline(e,i){const{renderOccluded:t,output:l}=e,p=e.backfaceCullingEnabled&&!t;return s({blending:t?o:null,culling:p?a:null,depthTest:t?null:{func:513},depthWrite:t?null:u,colorWrite:c,stencilTest:i?n(1):null,drawBuffers:r(l)})}getPipeline(){return this.useStencil?this._stencilPipelineState:super.getPipeline()}}export{p as TerrainTechnique};
