/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.34/esri/copyright.txt for details.
*/
import{isColorOrColorEmission as e}from"../core/shaderLibrary/ShaderOutput.js";import{ReloadableShaderModule as t}from"../core/shaderTechnique/ReloadableShaderModule.js";import{ShaderTechnique as i}from"../core/shaderTechnique/ShaderTechnique.js";import{oitPolygonOffset as r,getDrawBuffers as l,depthWrite as n,oitDepthTest as s,blending as o}from"../lib/OrderIndependentTransparency.js";import{stencilToolMaskBaseParams as a,stencilBaseAllZerosParams as p,stencilWriteMaskOn as c}from"../lib/StencilUtils.js";import{PositionUvLayout as u}from"../materials/DefaultLayouts.js";import{I as d}from"../../../../chunks/ImageMaterial.glsl.js";import{makePipelineState as m,defaultColorWrite as h,cullingParams as f}from"../../../webgl/renderState.js";class g extends i{constructor(e,i){super(e,i,new t(d,()=>import("./ImageMaterial.glsl.js")),j(i).locations)}_getPipelineState(t,i){const{oitPass:u,output:d,hasOccludees:g,cullFace:j}=t;return m({blending:e(d)?o(u,!0):null,culling:f(j),depthTest:{func:s(u)},depthWrite:n(t),drawBuffers:l(u,d),colorWrite:h,stencilWrite:g?c:null,stencilTest:g?i?a:p:null,polygonOffset:r(t)})}initializePipeline(e){return this._occludeePipeline=this._getPipelineState(e,!0),this._getPipelineState(e,!1)}getPipeline(e){return e?this._occludeePipeline:super.getPipeline()}}function j(e){let t=u;return e.perspectiveInterpolation&&(t=t.clone().f32("perspectiveDivide")),t}export{g as ImageMaterialTechnique,j as getLayout};
