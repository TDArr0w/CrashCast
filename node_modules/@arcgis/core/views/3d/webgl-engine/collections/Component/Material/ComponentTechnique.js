/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.34/esri/copyright.txt for details.
*/
import{glLayout as e}from"../../../../support/buffer/glUtil.js";import{newLayout as r}from"../../../../support/buffer/InterleavedLayout.js";import{createVertexBufferLayout as t}from"../SourceGeometry.js";import{C as o}from"../../../../../../chunks/ComponentShader.glsl.js";import{isColorOrColorEmission as n}from"../../../core/shaderLibrary/ShaderOutput.js";import{ReloadableShaderModule as s}from"../../../core/shaderTechnique/ReloadableShaderModule.js";import{ShaderTechnique as l,depthOnlyOutputBuffersOr as i}from"../../../core/shaderTechnique/ShaderTechnique.js";import{OITPolygonOffset as u,oitDepthTest as d,blending as a,getDrawBuffers as c}from"../../../lib/OrderIndependentTransparency.js";import{replaceBitWhenDepthTestPasses as p,stencilBaseAllZerosParams as m,stencilWriteMaskOn as f}from"../../../lib/StencilUtils.js";import{makePipelineState as h,defaultColorWrite as b,defaultDepthWrite as j,cullingParams as g,premultipliedAlpha as S}from"../../../../../webgl/renderState.js";import{fromLayouts as y}from"../../../../../webgl/VertexAttributeLocations.js";class O extends l{constructor(r,n){super(r,n,new s(o,()=>import("./shader/ComponentShader.glsl.js")),y([e(t(n)),T]))}initializePipeline(e){const{integratedMeshMode:r,output:t,blendingEnabled:o,cullFace:s,hasOccludees:l,hasPolygonOffset:y,oitPass:O,renderOccluded:T}=e,w=0!==r,x=0===O,q=2===O;return h({blending:T?S:n(t)&&o?a(O):null,culling:g(s),depthTest:T?null:{func:d(O)},depthWrite:T||!x&&!q?null:j,drawBuffers:i(t,c(O,t)),colorWrite:b,stencilWrite:!T&&w||l?f:null,stencilTest:w?p(1):l?m:null,polygonOffset:x||q?y?{factor:2,units:2}:null:u})}}const T=e(r().u16("componentIndex"));export{O as ComponentTechnique,T as indexGlLayout};
