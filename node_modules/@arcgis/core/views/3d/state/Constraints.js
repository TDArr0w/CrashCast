/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.34/esri/copyright.txt for details.
*/
import{__decorate as t}from"tslib";import e from"../../../core/Accessor.js";import i from"../../../core/Logger.js";import{clamp as o,deg2rad as r}from"../../../core/mathUtils.js";import{property as s}from"../../../core/accessorSupport/decorators/property.js";import"../../../core/has.js";import"../../../core/RandomLCG.js";import{subclass as n}from"../../../core/accessorSupport/decorators/subclass.js";import{earth as a}from"../../../geometry/support/Ellipsoid.js";import{makePiecewiseLinearFunction as l}from"../support/mathUtils.js";let m=class extends e{constructor(t){super(t),this.collision=new h,this.distance=1/0,this.minimumPoiDistance=4,this.tilt=null}get altitude(){return 2===this.mode?null:this._get("altitude")||null}set altitude(t){2!==this.mode?this._set("altitude",t):i.getLogger(this).warn("Altitude constraint is ignored in local scenes")}get mode(){return this.state.viewingMode}clampAltitude(t){return this.altitude?o(t,this.altitude.min,this.altitude.max):t}clampTilt(t,e){if(!this.tilt)return e;const i=this.tilt(t);return o(e,i.min,i.max)}clampDistance(t){return Math.min(t,this.distance)}createDefaultTilt(){return 2===this.mode?this._createDefaultTiltLocal():this._createDefaultTiltGlobal()}createConstantMaxTilt(t){return(e,i=d)=>(i.min=u.min,i.max=t,i)}_createDefaultTiltLocal(){const t=this.collision.enabled?l([[4e3,u.max],[1e4,r(88)],[6e6,r(88)]]):()=>u.max;return(e,i=d)=>(i.min=u.min,i.max=t(e),i)}_createDefaultTiltGlobal(){const t=this.collision.enabled?l([[4e3,u.max],[5e4,r(88)],[6e6,r(88)],[2e7,u.min]]):l([[3e5,u.max],[3e6,r(88)],[6e6,r(88)],[2e7,u.min]]);return(e,i=d)=>(i.min=u.min,i.max=t(e),i)}};function c(t){return{min:-2e5,max:4*t.radius}}t([s()],m.prototype,"altitude",null),t([s({readOnly:!0})],m.prototype,"collision",void 0),t([s()],m.prototype,"distance",void 0),t([s({readOnly:!0})],m.prototype,"minimumPoiDistance",void 0),t([s()],m.prototype,"tilt",void 0),t([s({constructOnly:!0})],m.prototype,"state",void 0),m=t([n("esri.views.3d.state.Constraints")],m);const p=c(a),u={min:r(.5),max:r(179.5)},d={min:0,max:0};let h=class extends e{constructor(){super(...arguments),this.enabled=!0,this.elevationMargin=5}};t([s({type:Boolean})],h.prototype,"enabled",void 0),t([s({type:Number})],h.prototype,"elevationMargin",void 0),h=t([n("esri.views.3d.state.Constraints.CollisionConstraint")],h);export{m as Constraints,u as TiltRange,p as earthAltitudeConstraint};
