/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.34/esri/copyright.txt for details.
*/
import{isSome as t}from"../../../core/arrayUtils.js";import{getEffectiveFieldAlias as e}from"../../../editing/fieldUtils.js";import{getDisplayFieldName as o}from"../../../layers/support/fieldUtils.js";import{findEditorItemForLayer as r}from"../workflowUtils.js";import{loadPanelContentComponents as s,PanelContentSection as i,PanelContent as a}from"./PanelContent.js";import{loadCalciteComponents as l}from"../../support/componentsUtils.js";import{ItemList as n}from"../../support/ItemList.js";import"../../support/widgetUtils.js";import{tsx as c}from"../../support/jsxFactory.js";import"@arcgis/toolkit/dom";const m=()=>Promise.all([s(),l({action:()=>import("@esri/calcite-components/dist/components/calcite-action")})]);function d({editorItems:e,filterText:o,id:s,messagesTemplates:l,onFilterTextChange:m,onSelectFeature:d,onZoomTo:f,workflow:j,editorMessages:g}){const y=new Map,I=j.data.candidates;let b=0;I.map(t=>({label:p(t),id:t.attributes[t.layer.objectIdField],data:t})).filter(({label:t,data:s})=>{const i=o.toLowerCase(),{title:a}=s.layer,l=r(e,s.sourceLayer);return l?l.supportsUpdateWorkflow&&(!i||t?.toLowerCase().includes(i)||a?.toLowerCase().includes(i)):null}).filter(t).forEach(t=>{b++;const e=t.data.layer;y.has(e)?y.get(e)?.items.push(t):y.set(e,{id:`${e.id}`,label:e.title??"",items:[t]})});const h=e.toArray().map(({layer:t})=>y.get(t)).filter(t),w=b>10||o.length>0;return c(a,{key:"feature-list"},c(i,null,n({enableListScroll:!1,filterEnabled:w,filterText:o,id:s,items:h,messages:{filterPlaceholder:l.filterPlaceholder,noItems:l.noItems,noMatches:l.noMatches},onFilterChange:t=>m(t),onItemMouseEnter:t=>d(t.data),onItemMouseLeave:()=>d(null),onItemSelect:t=>d(t.data,!0),renderItemActionEnd:t=>u(t.data,f,g.zoomTo)})))}function p(t){const r=t.sourceLayer??t.layer;if(!r)return null;const s=r.fieldsIndex.get(r.objectIdField);if(!s)return null;const i=e(s,r)||s.name,a=t.attributes,l=o(r);return l&&a[l]&&`${a[l]}`||`${i}: ${a[s.name]}`}function u(t,e,o){return c("calcite-action",{appearance:"transparent",icon:"zoom-to-object",onclick:()=>e(t),scale:"s",slot:"actions-end",text:o,title:o})}export{d as FeatureList,m as loadFeatureListComponents};
