/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.34/esri/copyright.txt for details.
*/
import{__decorate as t}from"tslib";import{createTask as e}from"../../../core/asyncUtils.js";import{Cyclical as i}from"../../../core/Cyclical.js";import{throwIfAborted as o}from"../../../core/promiseUtils.js";import{whenOnce as r}from"../../../core/reactiveUtils.js";import{property as n}from"../../../core/accessorSupport/decorators/property.js";import"../../../core/has.js";import"../../../core/Logger.js";import"../../../core/RandomLCG.js";import{subclass as s}from"../../../core/accessorSupport/decorators/subclass.js";import c from"../../Widget.js";import{css as a}from"../css.js";import l from"./NavigationUIPanoramicViewModel.js";import{loadCalciteComponents as d}from"../../support/componentsUtils.js";import"../../support/widgetUtils.js";import{tsx as p}from"../../support/jsxFactory.js";import"@arcgis/toolkit/dom";let u=class extends c{constructor(t){super(t),this.directionMode="Relative",this.navigate=null,this.viewModel=new l,this._clickTask=null,this._handleClick=t=>{this._clickTask?.abort(),this._clickTask=e(async e=>{const i=t.target;if(!this.navigate||!this.currentNode)return;await r(()=>"compiled"===this.viewModel.state,{signal:e});const n=i.getAttribute("data-direction");o(e),await this.navigate(this.currentNode,{direction:n,signal:e})})},this.wrapTo90=t=>{const e=90*Math.round(t/90);return new i(-90,90).normalize(t-e)}}loadDependencies(){return d({icon:()=>import("@esri/calcite-components/dist/components/calcite-icon")})}set currentNode(t){this.viewModel.currentNode=t}get currentNode(){return this.viewModel.currentNode}set currentBestFeature(t){this.viewModel.currentBestFeature=t}get currentBestFeature(){return this.viewModel.currentBestFeature}get nodes(){return this.viewModel.nodes}set nodes(t){this.viewModel.nodes=t}render(){const{currentNode:t,currentBestFeature:e,directionMode:i}=this;if(!t)return null;if(!e)return null;const o=this.wrapTo90(e.attributes.cameraHeading),{currentHeading:r}=t,n={"--rotate-transform":` rotate(${"Relative"===i?-r+o:-r}deg)`},s=t=>{const e=(t-(r??0)+360)%360;return e<45||e>=315?"towards":e>=135&&e<225?"backwards":e>=45&&e<135?"right":"left"},c=s(0),l=s(90),d=s(180),u=s(270);return p("div",{class:a.navigationUI},p("div",{class:a.navigationDirectionPad,styles:n},t[c]?p("calcite-icon",{class:this.classes(a.navigationDirection,a.navigationTop),"data-direction":c,icon:"chevron-up",key:"chevron-up",onclick:this._handleClick}):null,t[l]?p("calcite-icon",{class:this.classes(a.navigationDirection,a.navigationRight),"data-direction":l,icon:"chevron-right",key:"chevron-right",onclick:this._handleClick}):null,t[d]?p("calcite-icon",{class:this.classes(a.navigationDirection,a.navigationBottom),"data-direction":d,icon:"chevron-down",key:"chevron-down",onclick:this._handleClick}):null,t[u]?p("calcite-icon",{class:this.classes(a.navigationDirection,a.navigationLeft),"data-direction":u,icon:"chevron-left",key:"chevron-left",onclick:this._handleClick}):null))}};t([n()],u.prototype,"currentNode",null),t([n()],u.prototype,"directionMode",void 0),t([n()],u.prototype,"currentBestFeature",null),t([n()],u.prototype,"navigate",void 0),t([n({nonNullable:!0})],u.prototype,"nodes",null),t([n()],u.prototype,"viewModel",void 0),t([n()],u.prototype,"_clickTask",void 0),u=t([s("esri.widgets.OrientedImageryViewer.components.NavigationUI360")],u);const h=u;export{h as default};
