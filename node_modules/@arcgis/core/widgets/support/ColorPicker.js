/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.34/esri/copyright.txt for details.
*/
import{__decorate as o}from"tslib";import e from"../../Color.js";import{watch as t,syncAndInitial as r}from"../../core/reactiveUtils.js";import{property as s}from"../../core/accessorSupport/decorators/property.js";import"../../core/has.js";import"../../core/Logger.js";import"../../core/RandomLCG.js";import{subclass as i}from"../../core/accessorSupport/decorators/subclass.js";import n from"../Widget.js";import{loadCalciteComponents as a}from"./componentsUtils.js";import"./widgetUtils.js";import{messageBundle as p}from"./decorators/messageBundle.js";import{tsx as c}from"./jsxFactory.js";import"@arcgis/toolkit/dom";const l="esri-color-picker",m={base:l,backgroundPattern:`${l}__bg-pattern`,toggleButton:`${l}__toggle-button`,popover:`${l}__popover`};let d=class extends n{constructor(o,t){super(o,t),this.value=new e,this.alphaEnabled=!0,this._containerElement=null,this._button=null,this._open=!1,this._onColorInput=o=>{const t=o.currentTarget.value,r="string"==typeof t?new e(t):new e;this.value=r,this.onChange?.(r)}}initialize(){this.addHandles(t(()=>({container:this._containerElement,value:this.value}),({container:o,value:e})=>{o?.style.setProperty("--esri-color-picker-value",e.toCss(!0))},r))}loadDependencies(){return a({button:()=>import("@esri/calcite-components/dist/components/calcite-button"),"color-picker":()=>import("@esri/calcite-components/dist/components/calcite-color-picker"),popover:()=>import("@esri/calcite-components/dist/components/calcite-popover")})}render(){const o=this._messages,e=this._open?o.close:o.open;return c("div",{afterCreate:o=>this._containerElement=o,class:this.classes(m.base,this.class)},c("div",{class:m.backgroundPattern,key:"background-pattern"}),c("calcite-button",{afterCreate:o=>this._button=o,appearance:"transparent",class:m.toggleButton,key:"popover-trigger",kind:"neutral",label:e,scale:"s",tabIndex:0,title:e}),c("calcite-popover",{autoClose:!0,class:m.popover,key:"popover",label:o.label,overlayPositioning:"fixed",referenceElement:this._button,onCalcitePopoverClose:()=>this._open=!1,onCalcitePopoverOpen:()=>this._open=!0},c("calcite-color-picker",{alphaChannel:this.alphaEnabled,channelsDisabled:!0,key:"color-picker",onclick:o=>{o.stopPropagation()},savedDisabled:!0,value:this.value.toCss(!0),onCalciteColorPickerInput:this._onColorInput})))}};o([s()],d.prototype,"class",void 0),o([s()],d.prototype,"value",void 0),o([s()],d.prototype,"alphaEnabled",void 0),o([s()],d.prototype,"onChange",void 0),o([s()],d.prototype,"_containerElement",void 0),o([s()],d.prototype,"_button",void 0),o([s()],d.prototype,"_open",void 0),o([s(),p("esri/widgets/support/t9n/ColorPicker")],d.prototype,"_messages",void 0),d=o([i("esri.widgets.support.ColorPicker")],d);export{d as ColorPicker};
