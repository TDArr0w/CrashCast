/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.34/esri/copyright.txt for details.
*/
import{__decorate as e}from"tslib";import t from"../Camera.js";import{property as i}from"../core/accessorSupport/decorators/property.js";import"../core/has.js";import"../core/Logger.js";import"../core/RandomLCG.js";import{subclass as o}from"../core/accessorSupport/decorators/subclass.js";import r from"./Widget.js";import a from"./PanoramicViewer/PanoramicVideoViewerViewModel.js";import{loadCalciteComponents as s}from"./support/componentsUtils.js";import{globalCss as l}from"./support/globalCss.js";import"./support/widgetUtils.js";import{messageBundle as c}from"./support/decorators/messageBundle.js";import{vmEvent as n}from"./support/decorators/vmEvent.js";import{tsx as d}from"./support/jsxFactory.js";import"@arcgis/toolkit/dom";const p="esri-panoramic-viewer";let m=class extends r{constructor(e){super(e),this.messagesCommon=null,this.viewModel=new a,this._afterContainerCreate=e=>{this.imageRenderer.container=e},this.addGraphic=(e,t)=>{this.viewModel.addGraphic(e,t)},this.addManyGraphics=e=>{this.viewModel.addManyGraphics(e)},this.clearGraphics=()=>{this.viewModel.clearGraphics()},this.clearImage=()=>{this.viewModel.clearImage()},this.loadVideo=e=>this.viewModel.loadVideo(e),this.removeGraphic=e=>{this.viewModel.removeGraphic(e)},this.removeManyGraphics=e=>{this.viewModel.removeManyGraphics(e)}}loadDependencies(){return s({panel:()=>import("@esri/calcite-components/dist/components/calcite-panel"),"action-bar":()=>import("@esri/calcite-components/dist/components/calcite-action-bar"),"action-group":()=>import("@esri/calcite-components/dist/components/calcite-action-group"),action:()=>import("@esri/calcite-components/dist/components/calcite-action"),slider:()=>import("@esri/calcite-components/dist/components/calcite-slider")})}get activeAudioIcon(){const{videoMuted:e}=this.viewModel;return e?"sound-off":"sound"}get activeVideoIcon(){const{videoPaused:e,videoLoaded:t}=this.viewModel;return t&&!1===e?"pause":"play"}get autoLoad(){return this.viewModel.autoLoad}set autoLoad(e){this.viewModel.autoLoad=e}get camera(){return this.viewModel.camera}set camera(e){e&&(this.viewModel.camera=e)}get clickAction(){return this.viewModel.clickAction}set clickAction(e){this.viewModel.clickAction=e}get fov(){return this.camera?.fov}set fov(e){this.viewModel.fov=e}get hfov(){return this.viewModel.hfov}get icon(){return"i360-view"}set icon(e){this._overrideIfSome("icon",e)}get imageRenderer(){return this.viewModel.imageRenderer}get imageSize(){return this.viewModel.imageSize}get oiViewModel(){return this.viewModel.oiViewModel}set oiViewModel(e){this.viewModel.oiViewModel=e}get video(){return this.viewModel.video}get videoSource(){return this.viewModel.videoSource}set videoSource(e){this.viewModel.videoSource=e}get pitch(){return this.viewModel.pitch}set pitch(e){this.viewModel.pitch=e}get state(){return this.viewModel.state}get ui(){return this.imageRenderer.ui}get vfov(){return this.viewModel.vfov}get yaw(){return this.viewModel.yaw}set yaw(e){this.viewModel.yaw=e}_handleVideoSeek(e){const t=this.viewModel?.video;t&&(t.currentTime=e.target.value,t.play())}render(){const{control:e,reset:t}=this.messagesCommon,{mute:i,unmute:o}=this.messages;return d("calcite-panel",null,d("calcite-panel",{loading:this.viewModel.updating},d("calcite-panel",{afterCreate:this._afterContainerCreate,bind:this,class:this.classes(l.widget,p)}),d("calcite-slider",{bind:this,labelHandles:!0,labelTicks:!0,max:this.viewModel?.videoDuration,minLabel:"0",value:this.viewModel.currentTime??0,onCalciteSliderChange:this._handleVideoSeek}),d("calcite-action-bar",{expandDisabled:!0,layout:"horizontal"},d("calcite-action-group",null,d("calcite-action",{bind:this,icon:this.activeVideoIcon,onclick:()=>this.viewModel.playPanoramicVideoHandler(),text:"Play",title:this.viewModel.videoPaused?e.play:e.pause})),d("calcite-action-group",null,d("calcite-action",{bind:this,icon:"refresh",onclick:()=>this.viewModel.rewindPanoramicVideoHandler(),text:"Rewind",title:t})),d("calcite-action-group",null,d("calcite-action",{bind:this,icon:this.activeAudioIcon,onclick:()=>this.viewModel.togglePanoramicAudio(),text:"Audio",title:this.viewModel.videoMuted?i:o})))))}static{this.vnodeSelector="calcite-panel"}};e([i()],m.prototype,"activeAudioIcon",null),e([i()],m.prototype,"activeVideoIcon",null),e([i({type:Boolean})],m.prototype,"autoLoad",null),e([i({type:t})],m.prototype,"camera",null),e([i()],m.prototype,"clickAction",null),e([i({type:Number})],m.prototype,"fov",null),e([i({readOnly:!0,type:Number})],m.prototype,"hfov",null),e([i()],m.prototype,"icon",null),e([i({readOnly:!0})],m.prototype,"imageRenderer",null),e([i({readOnly:!0})],m.prototype,"imageSize",null),e([i()],m.prototype,"oiViewModel",null),e([i(),c("esri/widgets/OrientedImageryViewer/t9n/OrientedImageryViewer")],m.prototype,"messages",void 0),e([i(),c("esri/t9n/common")],m.prototype,"messagesCommon",void 0),e([i()],m.prototype,"video",null),e([i()],m.prototype,"videoSource",null),e([i({type:Number})],m.prototype,"pitch",null),e([i({readOnly:!0})],m.prototype,"state",null),e([i()],m.prototype,"ui",null),e([i({readOnly:!0,type:Number})],m.prototype,"vfov",null),e([n(["click","hittest-response","pixel-location"]),i({type:a})],m.prototype,"viewModel",void 0),e([i({type:Number})],m.prototype,"yaw",null),m=e([o("esri.widgets.PanoramicVideoViewer")],m);const u=m;export{u as default};
